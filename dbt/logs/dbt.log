[0m19:34:20.083919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781ab71edb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781ab7abb770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781ab78dc7d0>]}


============================== 19:34:20.105733 | 37226353-bea9-4be7-b0e8-656728ece13a ==============================
[0m19:34:20.105733 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:34:20.108382 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'quiet': 'False', 'printer_width': '80', 'use_colors': 'True', 'log_path': 'logs', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'introspect': 'True', 'log_format': 'default', 'empty': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'version_check': 'True', 'write_json': 'True', 'target_path': 'None'}
[0m19:34:20.154387 [info ] [MainThread]: dbt version: 1.11.2
[0m19:34:20.156489 [info ] [MainThread]: python version: 3.12.10
[0m19:34:20.158732 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m19:34:20.161919 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m19:34:20.164484 [info ] [MainThread]: Using profiles dir at /home/airflow/.dbt
[0m19:34:20.166471 [info ] [MainThread]: Using profiles.yml file at /home/airflow/.dbt/profiles.yml
[0m19:34:20.168489 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m19:34:20.172340 [info ] [MainThread]: Configuration:
[0m19:34:20.173896 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m19:34:20.175656 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m19:34:20.177574 [info ] [MainThread]: Required dependencies:
[0m19:34:20.179343 [debug] [MainThread]: Executing "git --help"
[0m19:34:20.183635 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m19:34:20.185549 [info ] [MainThread]: Connection test skipped since no profile was found
[0m19:34:20.187896 [info ] [MainThread]: [31m3 checks failed:[0m
[0m19:34:20.189638 [info ] [MainThread]: dbt looked for a profiles.yml file in /home/airflow/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m19:34:20.191390 [info ] [MainThread]: Project loading failed for the following reason:
 project path </opt/airflow/dbt/dbt_project.yml> not found

[0m19:34:20.193097 [info ] [MainThread]: Error from git --help: User does not have permissions for this command: "git"

[0m19:34:20.200426 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.21056925, "process_in_blocks": "1656", "process_kernel_time": 1.372911, "process_mem_max_rss": "107392", "process_out_blocks": "1064", "process_user_time": 3.607884}
[0m19:34:20.202602 [debug] [MainThread]: Command `dbt debug` failed at 19:34:20.202285 after 0.21 seconds
[0m19:34:20.204053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781ab749d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781ab75748f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781ab7742480>]}
[0m19:34:20.205574 [debug] [MainThread]: Flushing usage events
[0m19:34:21.227622 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:36:13.709628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d469506d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d468fc8200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d46aa7f1a0>]}


============================== 19:36:13.737836 | b29af859-1e59-41f3-8042-64116a79a858 ==============================
[0m19:36:13.737836 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:36:13.740663 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'empty': 'False', 'profiles_dir': '/opt/airflow/dbt', 'introspect': 'True', 'invocation_command': 'dbt run', 'write_json': 'True', 'use_colors': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'printer_width': '80', 'partial_parse': 'True', 'quiet': 'False', 'no_print': 'None', 'log_path': '/opt/airflow/dbt/logs', 'use_experimental_parser': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'static_parser': 'True'}
[0m19:36:15.111547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b29af859-1e59-41f3-8042-64116a79a858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d467f01490>]}
[0m19:36:15.224335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b29af859-1e59-41f3-8042-64116a79a858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d46970e240>]}
[0m19:36:15.226588 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m19:36:15.487593 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:36:15.494948 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:36:15.496301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b29af859-1e59-41f3-8042-64116a79a858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d468a97680>]}
[0m19:36:16.725819 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.final_project.staging
- models.final_project.mart
[0m19:36:16.736093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b29af859-1e59-41f3-8042-64116a79a858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d467382d80>]}
[0m19:36:16.839570 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:36:16.871552 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:36:16.948959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b29af859-1e59-41f3-8042-64116a79a858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d46732bad0>]}
[0m19:36:16.951253 [info ] [MainThread]: Found 463 macros
[0m19:36:16.954033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b29af859-1e59-41f3-8042-64116a79a858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d468ae4ad0>]}
[0m19:36:16.961712 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:36:16.967123 [debug] [MainThread]: Command end result
[0m19:36:17.041819 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:36:17.055388 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:36:17.073683 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m19:36:17.078476 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.5218654, "process_in_blocks": "656", "process_kernel_time": 2.625569, "process_mem_max_rss": "117732", "process_out_blocks": "0", "process_user_time": 5.609715}
[0m19:36:17.080130 [debug] [MainThread]: Command `dbt run` succeeded at 19:36:17.079869 after 3.52 seconds
[0m19:36:17.081431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d469b1c650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d468e242c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d4673735c0>]}
[0m19:36:17.082916 [debug] [MainThread]: Flushing usage events
[0m19:36:18.172147 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:36:25.963718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9f9d10d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9f9f7f08f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9f9d10d910>]}


============================== 19:36:25.978879 | 5d023f0d-6f7a-4ba3-95df-190467efaf6a ==============================
[0m19:36:25.978879 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:36:25.980729 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'static_parser': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'use_colors': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'no_print': 'None', 'empty': 'None', 'warn_error': 'None', 'printer_width': '80', 'log_format': 'default', 'partial_parse': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test', 'fail_fast': 'False', 'indirect_selection': 'eager', 'debug': 'False'}
[0m19:36:26.264982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d023f0d-6f7a-4ba3-95df-190467efaf6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9f9d14aff0>]}
[0m19:36:26.360707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d023f0d-6f7a-4ba3-95df-190467efaf6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9f9d581280>]}
[0m19:36:26.362361 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m19:36:26.541374 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:36:26.668482 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:36:26.669574 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:36:26.670473 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:36:26.671908 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.final_project.staging
- models.final_project.mart
[0m19:36:26.684761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d023f0d-6f7a-4ba3-95df-190467efaf6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9f9b930230>]}
[0m19:36:26.809433 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:36:26.821889 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:36:26.890444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d023f0d-6f7a-4ba3-95df-190467efaf6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9f9b1b3bc0>]}
[0m19:36:26.892303 [info ] [MainThread]: Found 463 macros
[0m19:36:26.894076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d023f0d-6f7a-4ba3-95df-190467efaf6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9f9b906870>]}
[0m19:36:26.899239 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:36:26.904622 [debug] [MainThread]: Command end result
[0m19:36:26.977130 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:36:26.996837 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:36:27.020089 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m19:36:27.023269 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.1817687, "process_in_blocks": "0", "process_kernel_time": 0.639741, "process_mem_max_rss": "120068", "process_out_blocks": "0", "process_user_time": 3.826451}
[0m19:36:27.025510 [debug] [MainThread]: Command `dbt test` succeeded at 19:36:27.024976 after 1.18 seconds
[0m19:36:27.028421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9f9d84a030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9f9bdbd340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9f9c9d1190>]}
[0m19:36:27.030569 [debug] [MainThread]: Flushing usage events
[0m19:36:27.866596 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:38:10.759903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee5aa7d6c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee5aa7d6e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee5aa92a360>]}


============================== 19:38:10.773958 | eb0b5484-af44-44fc-9dad-c3f7529af211 ==============================
[0m19:38:10.773958 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:38:10.775766 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'printer_width': '80', 'log_cache_events': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'target_path': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'no_print': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'log_path': '/opt/airflow/dbt/logs', 'empty': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m19:38:11.053558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb0b5484-af44-44fc-9dad-c3f7529af211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee5a973aa50>]}
[0m19:38:11.148568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb0b5484-af44-44fc-9dad-c3f7529af211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee5aa92ad20>]}
[0m19:38:11.150267 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m19:38:11.325329 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:38:11.331501 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:38:11.332887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eb0b5484-af44-44fc-9dad-c3f7529af211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee5a9f08ad0>]}
[0m19:38:12.488740 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.final_project.staging
- models.final_project.mart
- models
[0m19:38:12.499109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb0b5484-af44-44fc-9dad-c3f7529af211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee5a8b5eff0>]}
[0m19:38:12.586219 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:38:12.600852 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:38:12.648292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb0b5484-af44-44fc-9dad-c3f7529af211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee5a8b8dd30>]}
[0m19:38:12.650163 [info ] [MainThread]: Found 463 macros
[0m19:38:12.651761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb0b5484-af44-44fc-9dad-c3f7529af211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee5a8b2c380>]}
[0m19:38:12.658638 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:38:12.660626 [debug] [MainThread]: Command end result
[0m19:38:12.719032 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:38:12.732083 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:38:12.746300 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m19:38:12.748774 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1261766, "process_in_blocks": "0", "process_kernel_time": 0.596258, "process_mem_max_rss": "117644", "process_out_blocks": "0", "process_user_time": 4.573983}
[0m19:38:12.750353 [debug] [MainThread]: Command `dbt run` succeeded at 19:38:12.750121 after 2.13 seconds
[0m19:38:12.751501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee5aad3d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee5aa7a3e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee5aa7a2c30>]}
[0m19:38:12.752823 [debug] [MainThread]: Flushing usage events
[0m19:38:13.743292 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:38:20.066828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9f09de1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9f09529580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9f0952bef0>]}


============================== 19:38:20.083155 | 1f7eb866-2c51-485f-8162-f879eb656b5f ==============================
[0m19:38:20.083155 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:38:20.085073 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'target_path': 'None', 'log_cache_events': 'False', 'no_print': 'None', 'fail_fast': 'False', 'static_parser': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'warn_error': 'None', 'partial_parse': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'cache_selected_only': 'False', 'printer_width': '80', 'introspect': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt test', 'use_colors': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'write_json': 'True'}
[0m19:38:20.479170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f7eb866-2c51-485f-8162-f879eb656b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9f0b795dc0>]}
[0m19:38:20.595631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f7eb866-2c51-485f-8162-f879eb656b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9f0810b710>]}
[0m19:38:20.597522 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m19:38:20.791382 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:38:20.952846 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:38:20.954302 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:38:20.956254 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:38:20.960482 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models
- models.final_project.staging
- models.final_project.mart
[0m19:38:20.975278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f7eb866-2c51-485f-8162-f879eb656b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9f081d9fd0>]}
[0m19:38:21.101703 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:38:21.117141 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:38:21.199135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f7eb866-2c51-485f-8162-f879eb656b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9f07d266f0>]}
[0m19:38:21.201086 [info ] [MainThread]: Found 463 macros
[0m19:38:21.203179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f7eb866-2c51-485f-8162-f879eb656b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9f075cff80>]}
[0m19:38:21.209448 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:38:21.218511 [debug] [MainThread]: Command end result
[0m19:38:21.297931 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:38:21.314282 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:38:21.331242 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m19:38:21.333962 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.3995198, "process_in_blocks": "0", "process_kernel_time": 0.655382, "process_mem_max_rss": "120060", "process_out_blocks": "0", "process_user_time": 3.968482}
[0m19:38:21.335740 [debug] [MainThread]: Command `dbt test` succeeded at 19:38:21.335338 after 1.40 seconds
[0m19:38:21.337319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9f09751f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9f07189e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9f09c40290>]}
[0m19:38:21.339076 [debug] [MainThread]: Flushing usage events
[0m19:38:22.121004 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:39:57.719155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c72732d8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c7274c3e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c72783e7e0>]}


============================== 19:39:57.732556 | 329cee21-f770-4017-a41e-e31167da4893 ==============================
[0m19:39:57.732556 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:39:57.734709 [debug] [MainThread]: running dbt with arguments {'log_path': '/opt/airflow/dbt/logs', 'printer_width': '80', 'fail_fast': 'False', 'partial_parse': 'True', 'quiet': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_cache_events': 'False', 'static_parser': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'no_print': 'None', 'write_json': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'target_path': 'None', 'debug': 'False', 'log_format': 'default'}
[0m19:39:58.011311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '329cee21-f770-4017-a41e-e31167da4893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c726a89c70>]}
[0m19:39:58.103558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '329cee21-f770-4017-a41e-e31167da4893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c72776c530>]}
[0m19:39:58.105640 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m19:39:58.292515 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:39:58.301447 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:39:58.303451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '329cee21-f770-4017-a41e-e31167da4893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c725f99c70>]}
[0m19:40:00.340900 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on 'stg_vehicle_types'
in package 'final_project' (models/staging/schema.yml). Arguments to generic
tests should be nested under the `arguments` property.
[0m19:40:00.342576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '329cee21-f770-4017-a41e-e31167da4893', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c724f60a40>]}
[0m19:40:00.701433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '329cee21-f770-4017-a41e-e31167da4893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c724f08800>]}
[0m19:40:00.891553 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:40:00.905674 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:40:00.956075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '329cee21-f770-4017-a41e-e31167da4893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c7257facc0>]}
[0m19:40:00.957755 [info ] [MainThread]: Found 3 models, 4 data tests, 2 sources, 463 macros
[0m19:40:00.959619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '329cee21-f770-4017-a41e-e31167da4893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c725fd5ac0>]}
[0m19:40:00.965301 [info ] [MainThread]: 
[0m19:40:00.967082 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:40:00.969437 [info ] [MainThread]: 
[0m19:40:00.972061 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:40:00.981784 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m19:40:01.171064 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m19:40:01.172853 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m19:40:01.174526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:01.203145 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.029 seconds
[0m19:40:01.205881 [debug] [ThreadPool]: On list_airflow: Close
[0m19:40:01.209798 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_staging)
[0m19:40:01.220397 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging"
[0m19:40:01.221499 [debug] [ThreadPool]: On list_airflow_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "connection_name": "list_airflow_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m19:40:01.222576 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:40:01.270590 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.048 seconds
[0m19:40:01.273892 [debug] [ThreadPool]: On list_airflow_staging: ROLLBACK
[0m19:40:01.275730 [debug] [ThreadPool]: On list_airflow_staging: Close
[0m19:40:01.285969 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:01.287507 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:40:01.289474 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:40:01.340703 [debug] [MainThread]: SQL status: SELECT 0 in 0.051 seconds
[0m19:40:01.344624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '329cee21-f770-4017-a41e-e31167da4893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c726a630e0>]}
[0m19:40:01.346503 [debug] [MainThread]: On master: ROLLBACK
[0m19:40:01.348381 [debug] [MainThread]: On master: COMMIT
[0m19:40:01.349593 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:01.350787 [debug] [MainThread]: On master: COMMIT
[0m19:40:01.352334 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:40:01.353360 [debug] [MainThread]: On master: Close
[0m19:40:01.376878 [debug] [Thread-1 (]: Began running node model.final_project.stg_manufacturers
[0m19:40:01.378453 [debug] [Thread-2 (]: Began running node model.final_project.stg_vehicle_types
[0m19:40:01.379876 [info ] [Thread-1 (]: 1 of 3 START sql view model staging.stg_manufacturers .......................... [RUN]
[0m19:40:01.381767 [info ] [Thread-2 (]: 2 of 3 START sql view model staging.stg_vehicle_types .......................... [RUN]
[0m19:40:01.384235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging, now model.final_project.stg_manufacturers)
[0m19:40:01.386435 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.final_project.stg_vehicle_types'
[0m19:40:01.387786 [debug] [Thread-1 (]: Began compiling node model.final_project.stg_manufacturers
[0m19:40:01.389405 [debug] [Thread-2 (]: Began compiling node model.final_project.stg_vehicle_types
[0m19:40:01.417245 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.stg_manufacturers"
[0m19:40:01.418683 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.stg_vehicle_types"
[0m19:40:01.459101 [debug] [Thread-2 (]: Began executing node model.final_project.stg_vehicle_types
[0m19:40:01.488127 [debug] [Thread-1 (]: Began executing node model.final_project.stg_manufacturers
[0m19:40:01.578955 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.stg_vehicle_types"
[0m19:40:01.580060 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.stg_manufacturers"
[0m19:40:01.618018 [debug] [Thread-1 (]: Using postgres connection "model.final_project.stg_manufacturers"
[0m19:40:01.619542 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_manufacturers"} */

  create view "airflow"."staging"."stg_manufacturers__dbt_tmp"
    
    
  as (
    select
    mfr_id,
    upper(trim(mfr_name)) as mfr_name,
    upper(country) as country,
    ingested_at
from "airflow"."raw"."manufacturers"
  );
[0m19:40:01.621067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:40:01.626514 [debug] [Thread-2 (]: Using postgres connection "model.final_project.stg_vehicle_types"
[0m19:40:01.628176 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_vehicle_types"} */

  create view "airflow"."staging"."stg_vehicle_types__dbt_tmp"
    
    
  as (
    select
    mfr_id,
    vehicle_type,
    ingested_at
from "airflow"."raw"."vehicle_types"
  );
[0m19:40:01.629885 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:40:01.680169 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.050 seconds
[0m19:40:01.681459 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.060 seconds
[0m19:40:01.701846 [debug] [Thread-2 (]: Using postgres connection "model.final_project.stg_vehicle_types"
[0m19:40:01.706739 [debug] [Thread-1 (]: Using postgres connection "model.final_project.stg_manufacturers"
[0m19:40:01.707555 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_vehicle_types"} */
alter table "airflow"."staging"."stg_vehicle_types__dbt_tmp" rename to "stg_vehicle_types"
[0m19:40:01.709061 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_manufacturers"} */
alter table "airflow"."staging"."stg_manufacturers__dbt_tmp" rename to "stg_manufacturers"
[0m19:40:01.714373 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m19:40:01.715414 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m19:40:01.761070 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: COMMIT
[0m19:40:01.762461 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: COMMIT
[0m19:40:01.764095 [debug] [Thread-1 (]: Using postgres connection "model.final_project.stg_manufacturers"
[0m19:40:01.766180 [debug] [Thread-2 (]: Using postgres connection "model.final_project.stg_vehicle_types"
[0m19:40:01.767827 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: COMMIT
[0m19:40:01.769263 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: COMMIT
[0m19:40:01.781433 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m19:40:01.782665 [debug] [Thread-2 (]: SQL status: COMMIT in 0.011 seconds
[0m19:40:01.794045 [debug] [Thread-1 (]: Applying DROP to: "airflow"."staging"."stg_manufacturers__dbt_backup"
[0m19:40:01.799769 [debug] [Thread-2 (]: Applying DROP to: "airflow"."staging"."stg_vehicle_types__dbt_backup"
[0m19:40:01.812748 [debug] [Thread-2 (]: Using postgres connection "model.final_project.stg_vehicle_types"
[0m19:40:01.811181 [debug] [Thread-1 (]: Using postgres connection "model.final_project.stg_manufacturers"
[0m19:40:01.814352 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_vehicle_types"} */
drop view if exists "airflow"."staging"."stg_vehicle_types__dbt_backup" cascade
[0m19:40:01.816035 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_manufacturers"} */
drop view if exists "airflow"."staging"."stg_manufacturers__dbt_backup" cascade
[0m19:40:01.821729 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m19:40:01.827689 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: Close
[0m19:40:01.828611 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m19:40:01.833037 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '329cee21-f770-4017-a41e-e31167da4893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c71720ecc0>]}
[0m19:40:01.837020 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: Close
[0m19:40:01.839413 [info ] [Thread-2 (]: 2 of 3 OK created sql view model staging.stg_vehicle_types ..................... [[32mCREATE VIEW[0m in 0.44s]
[0m19:40:01.842667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '329cee21-f770-4017-a41e-e31167da4893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c717205070>]}
[0m19:40:01.845439 [debug] [Thread-2 (]: Finished running node model.final_project.stg_vehicle_types
[0m19:40:01.848670 [info ] [Thread-1 (]: 1 of 3 OK created sql view model staging.stg_manufacturers ..................... [[32mCREATE VIEW[0m in 0.46s]
[0m19:40:01.854231 [debug] [Thread-1 (]: Finished running node model.final_project.stg_manufacturers
[0m19:40:01.858743 [debug] [Thread-2 (]: Began running node model.final_project.manufacturers_by_country
[0m19:40:01.860415 [info ] [Thread-2 (]: 3 of 3 START sql table model staging.manufacturers_by_country .................. [RUN]
[0m19:40:01.862882 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.final_project.stg_vehicle_types, now model.final_project.manufacturers_by_country)
[0m19:40:01.865149 [debug] [Thread-2 (]: Began compiling node model.final_project.manufacturers_by_country
[0m19:40:01.877980 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.manufacturers_by_country"
[0m19:40:01.915171 [debug] [Thread-2 (]: Began executing node model.final_project.manufacturers_by_country
[0m19:40:01.961567 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.manufacturers_by_country"
[0m19:40:02.000450 [debug] [Thread-2 (]: Using postgres connection "model.final_project.manufacturers_by_country"
[0m19:40:02.001965 [debug] [Thread-2 (]: On model.final_project.manufacturers_by_country: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.manufacturers_by_country"} */

  
    

  create  table "airflow"."staging"."manufacturers_by_country__dbt_tmp"
  
  
    as
  
  (
    select
    country,
    count(distinct mfr_id) as manufacturers_cnt
from "airflow"."staging"."stg_manufacturers"
group by country
  );
  
[0m19:40:02.003770 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:40:02.060554 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.057 seconds
[0m19:40:02.072100 [debug] [Thread-2 (]: Using postgres connection "model.final_project.manufacturers_by_country"
[0m19:40:02.073649 [debug] [Thread-2 (]: On model.final_project.manufacturers_by_country: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.manufacturers_by_country"} */
alter table "airflow"."staging"."manufacturers_by_country__dbt_tmp" rename to "manufacturers_by_country"
[0m19:40:02.075998 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:40:02.080068 [debug] [Thread-2 (]: On model.final_project.manufacturers_by_country: COMMIT
[0m19:40:02.081341 [debug] [Thread-2 (]: Using postgres connection "model.final_project.manufacturers_by_country"
[0m19:40:02.082416 [debug] [Thread-2 (]: On model.final_project.manufacturers_by_country: COMMIT
[0m19:40:02.085270 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m19:40:02.089578 [debug] [Thread-2 (]: Applying DROP to: "airflow"."staging"."manufacturers_by_country__dbt_backup"
[0m19:40:02.097143 [debug] [Thread-2 (]: Using postgres connection "model.final_project.manufacturers_by_country"
[0m19:40:02.098400 [debug] [Thread-2 (]: On model.final_project.manufacturers_by_country: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.manufacturers_by_country"} */
drop table if exists "airflow"."staging"."manufacturers_by_country__dbt_backup" cascade
[0m19:40:02.100180 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m19:40:02.103577 [debug] [Thread-2 (]: On model.final_project.manufacturers_by_country: Close
[0m19:40:02.105710 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '329cee21-f770-4017-a41e-e31167da4893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c7150fd2e0>]}
[0m19:40:02.107814 [info ] [Thread-2 (]: 3 of 3 OK created sql table model staging.manufacturers_by_country ............. [[32mSELECT 11[0m in 0.24s]
[0m19:40:02.110331 [debug] [Thread-2 (]: Finished running node model.final_project.manufacturers_by_country
[0m19:40:02.114107 [debug] [MainThread]: On master: COMMIT
[0m19:40:02.115240 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:02.116347 [debug] [MainThread]: On master: COMMIT
[0m19:40:02.117424 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:40:02.132212 [debug] [MainThread]: SQL status: COMMIT in 0.015 seconds
[0m19:40:02.133495 [debug] [MainThread]: On master: Close
[0m19:40:02.135219 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:40:02.138737 [debug] [MainThread]: Connection 'model.final_project.stg_manufacturers' was properly closed.
[0m19:40:02.140694 [debug] [MainThread]: Connection 'model.final_project.manufacturers_by_country' was properly closed.
[0m19:40:02.142005 [info ] [MainThread]: 
[0m19:40:02.143623 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 1.17 seconds (1.17s).
[0m19:40:02.147602 [debug] [MainThread]: Command end result
[0m19:40:02.234669 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:40:02.258074 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:40:02.292167 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m19:40:02.294385 [info ] [MainThread]: 
[0m19:40:02.297080 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:40:02.300219 [info ] [MainThread]: 
[0m19:40:02.307695 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m19:40:02.312753 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m19:40:02.318360 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.7259355, "process_in_blocks": "2016", "process_kernel_time": 0.985026, "process_mem_max_rss": "133200", "process_out_blocks": "0", "process_user_time": 6.775063}
[0m19:40:02.321099 [debug] [MainThread]: Command `dbt run` succeeded at 19:40:02.320768 after 4.73 seconds
[0m19:40:02.324021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c729a00380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c72532b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c727a48110>]}
[0m19:40:02.325851 [debug] [MainThread]: Flushing usage events
[0m19:40:03.408696 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:40:14.225750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bb82f607d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bb832409e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bb8072fc80>]}


============================== 19:40:14.244187 | db9f0dd9-aeaa-4eb7-8490-e2cb3f9c11fc ==============================
[0m19:40:14.244187 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:40:14.245826 [debug] [MainThread]: running dbt with arguments {'log_path': '/opt/airflow/dbt/logs', 'write_json': 'True', 'invocation_command': 'dbt test', 'empty': 'None', 'version_check': 'True', 'warn_error': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'printer_width': '80', 'partial_parse': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m19:40:14.712982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db9f0dd9-aeaa-4eb7-8490-e2cb3f9c11fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bb802f0bc0>]}
[0m19:40:14.806411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db9f0dd9-aeaa-4eb7-8490-e2cb3f9c11fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bb82e8cfe0>]}
[0m19:40:14.808177 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m19:40:15.004127 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:40:15.328926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:40:15.330019 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:40:15.331049 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:40:15.400318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db9f0dd9-aeaa-4eb7-8490-e2cb3f9c11fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bb7f340650>]}
[0m19:40:15.551487 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:40:15.565226 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:40:15.629820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db9f0dd9-aeaa-4eb7-8490-e2cb3f9c11fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bb7e34c230>]}
[0m19:40:15.631705 [info ] [MainThread]: Found 3 models, 4 data tests, 2 sources, 463 macros
[0m19:40:15.633296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db9f0dd9-aeaa-4eb7-8490-e2cb3f9c11fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bb802f1b20>]}
[0m19:40:15.640346 [info ] [MainThread]: 
[0m19:40:15.642393 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:40:15.644441 [info ] [MainThread]: 
[0m19:40:15.646800 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:40:15.655109 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_staging'
[0m19:40:15.725732 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging"
[0m19:40:15.727209 [debug] [ThreadPool]: On list_airflow_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "connection_name": "list_airflow_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m19:40:15.728609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:15.748518 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.020 seconds
[0m19:40:15.752686 [debug] [ThreadPool]: On list_airflow_staging: ROLLBACK
[0m19:40:15.754541 [debug] [ThreadPool]: On list_airflow_staging: Close
[0m19:40:15.764758 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:15.765915 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:40:15.767097 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:40:15.785574 [debug] [MainThread]: SQL status: SELECT 2 in 0.018 seconds
[0m19:40:15.789016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db9f0dd9-aeaa-4eb7-8490-e2cb3f9c11fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bb7e34da90>]}
[0m19:40:15.790748 [debug] [MainThread]: On master: ROLLBACK
[0m19:40:15.792191 [debug] [MainThread]: On master: COMMIT
[0m19:40:15.793206 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:15.794249 [debug] [MainThread]: On master: COMMIT
[0m19:40:15.795753 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:40:15.796817 [debug] [MainThread]: On master: Close
[0m19:40:15.805367 [debug] [Thread-1 (]: Began running node test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978
[0m19:40:15.806864 [debug] [Thread-2 (]: Began running node test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3
[0m19:40:15.807813 [info ] [Thread-1 (]: 1 of 4 START test not_null_stg_manufacturers_mfr_id ............................ [RUN]
[0m19:40:15.808977 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_vehicle_types_mfr_id ............................ [RUN]
[0m19:40:15.811130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging, now test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978)
[0m19:40:15.813251 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3'
[0m19:40:15.815383 [debug] [Thread-1 (]: Began compiling node test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978
[0m19:40:15.816628 [debug] [Thread-2 (]: Began compiling node test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3
[0m19:40:15.870475 [debug] [Thread-1 (]: Writing injected SQL for node "test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978"
[0m19:40:15.871476 [debug] [Thread-2 (]: Writing injected SQL for node "test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3"
[0m19:40:15.892806 [debug] [Thread-1 (]: Began executing node test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978
[0m19:40:15.924893 [debug] [Thread-2 (]: Began executing node test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3
[0m19:40:15.930439 [debug] [Thread-1 (]: Writing runtime sql for node "test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978"
[0m19:40:15.935858 [debug] [Thread-2 (]: Writing runtime sql for node "test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3"
[0m19:40:15.955555 [debug] [Thread-2 (]: Using postgres connection "test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3"
[0m19:40:15.957873 [debug] [Thread-2 (]: On test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select mfr_id
from "airflow"."staging"."stg_vehicle_types"
where mfr_id is null



  
  
      
    ) dbt_internal_test
[0m19:40:15.959676 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:40:15.966812 [debug] [Thread-1 (]: Using postgres connection "test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978"
[0m19:40:15.968427 [debug] [Thread-1 (]: On test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select mfr_id
from "airflow"."staging"."stg_manufacturers"
where mfr_id is null



  
  
      
    ) dbt_internal_test
[0m19:40:15.969843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:40:15.979627 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.020 seconds
[0m19:40:15.988888 [debug] [Thread-2 (]: On test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3: ROLLBACK
[0m19:40:15.990784 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.021 seconds
[0m19:40:15.992274 [debug] [Thread-2 (]: On test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3: Close
[0m19:40:15.994707 [debug] [Thread-1 (]: On test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978: ROLLBACK
[0m19:40:15.996817 [info ] [Thread-2 (]: 2 of 4 PASS not_null_stg_vehicle_types_mfr_id .................................. [[32mPASS[0m in 0.18s]
[0m19:40:15.998449 [debug] [Thread-1 (]: On test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978: Close
[0m19:40:16.000178 [debug] [Thread-2 (]: Finished running node test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3
[0m19:40:16.002506 [info ] [Thread-1 (]: 1 of 4 PASS not_null_stg_manufacturers_mfr_id .................................. [[32mPASS[0m in 0.19s]
[0m19:40:16.007049 [debug] [Thread-2 (]: Began running node test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7
[0m19:40:16.009734 [debug] [Thread-1 (]: Finished running node test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978
[0m19:40:16.011180 [info ] [Thread-2 (]: 3 of 4 START test relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_  [RUN]
[0m19:40:16.012493 [debug] [Thread-1 (]: Began running node test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa
[0m19:40:16.014317 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3, now test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7)
[0m19:40:16.015894 [info ] [Thread-1 (]: 4 of 4 START test unique_stg_manufacturers_mfr_id .............................. [RUN]
[0m19:40:16.017177 [debug] [Thread-2 (]: Began compiling node test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7
[0m19:40:16.018973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978, now test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa)
[0m19:40:16.032067 [debug] [Thread-1 (]: Began compiling node test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa
[0m19:40:16.036849 [debug] [Thread-2 (]: Writing injected SQL for node "test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7"
[0m19:40:16.049143 [debug] [Thread-1 (]: Writing injected SQL for node "test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa"
[0m19:40:16.063838 [debug] [Thread-2 (]: Began executing node test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7
[0m19:40:16.069265 [debug] [Thread-2 (]: Writing runtime sql for node "test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7"
[0m19:40:16.075183 [debug] [Thread-1 (]: Began executing node test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa
[0m19:40:16.081170 [debug] [Thread-1 (]: Writing runtime sql for node "test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa"
[0m19:40:16.098880 [debug] [Thread-2 (]: Using postgres connection "test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7"
[0m19:40:16.100489 [debug] [Thread-2 (]: On test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select mfr_id as from_field
    from "airflow"."staging"."stg_vehicle_types"
    where mfr_id is not null
),

parent as (
    select mfr_id as to_field
    from "airflow"."staging"."stg_manufacturers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m19:40:16.102294 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:40:16.111115 [debug] [Thread-1 (]: Using postgres connection "test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa"
[0m19:40:16.113161 [debug] [Thread-1 (]: On test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    mfr_id as unique_field,
    count(*) as n_records

from "airflow"."staging"."stg_manufacturers"
where mfr_id is not null
group by mfr_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:40:16.116706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:40:16.121643 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.019 seconds
[0m19:40:16.126177 [debug] [Thread-2 (]: On test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7: ROLLBACK
[0m19:40:16.127978 [debug] [Thread-2 (]: On test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7: Close
[0m19:40:16.133041 [info ] [Thread-2 (]: 3 of 4 PASS relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_  [[32mPASS[0m in 0.12s]
[0m19:40:16.138558 [debug] [Thread-2 (]: Finished running node test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7
[0m19:40:16.140097 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.023 seconds
[0m19:40:16.144134 [debug] [Thread-1 (]: On test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa: ROLLBACK
[0m19:40:16.145718 [debug] [Thread-1 (]: On test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa: Close
[0m19:40:16.147447 [info ] [Thread-1 (]: 4 of 4 PASS unique_stg_manufacturers_mfr_id .................................... [[32mPASS[0m in 0.13s]
[0m19:40:16.149209 [debug] [Thread-1 (]: Finished running node test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa
[0m19:40:16.152790 [debug] [MainThread]: On master: COMMIT
[0m19:40:16.153967 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:16.155002 [debug] [MainThread]: On master: COMMIT
[0m19:40:16.155923 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:40:16.168041 [debug] [MainThread]: SQL status: COMMIT in 0.012 seconds
[0m19:40:16.169257 [debug] [MainThread]: On master: Close
[0m19:40:16.170643 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:40:16.171648 [debug] [MainThread]: Connection 'test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa' was properly closed.
[0m19:40:16.172553 [debug] [MainThread]: Connection 'test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7' was properly closed.
[0m19:40:16.173997 [info ] [MainThread]: 
[0m19:40:16.176106 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m19:40:16.180293 [debug] [MainThread]: Command end result
[0m19:40:16.241243 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:40:16.254422 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:40:16.273559 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m19:40:16.275015 [info ] [MainThread]: 
[0m19:40:16.276554 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:40:16.278386 [info ] [MainThread]: 
[0m19:40:16.280665 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m19:40:16.286056 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.2915442, "process_in_blocks": "0", "process_kernel_time": 0.741488, "process_mem_max_rss": "129368", "process_out_blocks": "0", "process_user_time": 4.309405}
[0m19:40:16.287920 [debug] [MainThread]: Command `dbt test` succeeded at 19:40:16.287416 after 2.29 seconds
[0m19:40:16.290391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bb80631d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bb80567a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bb80564e60>]}
[0m19:40:16.292484 [debug] [MainThread]: Flushing usage events
[0m19:40:17.083017 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:59:16.439040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d8e9f03710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d8ec51c740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d8e9f03620>]}


============================== 19:59:16.472720 | 54b5d6cc-fb07-4632-b8d6-33e8ed17bbed ==============================
[0m19:59:16.472720 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:59:16.475520 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'warn_error': 'None', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'indirect_selection': 'eager', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'empty': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'printer_width': '80', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'debug': 'False', 'use_colors': 'True', 'introspect': 'True'}
[0m19:59:17.014124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54b5d6cc-fb07-4632-b8d6-33e8ed17bbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d8e960a8a0>]}
[0m19:59:17.116888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54b5d6cc-fb07-4632-b8d6-33e8ed17bbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d8ea0635f0>]}
[0m19:59:17.119350 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m19:59:17.373186 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:59:18.019760 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:59:18.021373 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:59:18.022567 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:59:18.118021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54b5d6cc-fb07-4632-b8d6-33e8ed17bbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d8ea0635c0>]}
[0m19:59:18.327677 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:59:18.343334 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:59:18.492770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54b5d6cc-fb07-4632-b8d6-33e8ed17bbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d8e818d5b0>]}
[0m19:59:18.495690 [info ] [MainThread]: Found 3 models, 4 data tests, 2 sources, 463 macros
[0m19:59:18.497940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54b5d6cc-fb07-4632-b8d6-33e8ed17bbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d8e819a630>]}
[0m19:59:18.502096 [info ] [MainThread]: 
[0m19:59:18.503465 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:59:18.504788 [info ] [MainThread]: 
[0m19:59:18.506943 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:59:18.516517 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m19:59:18.616807 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m19:59:18.618120 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m19:59:18.619487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:18.637987 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.018 seconds
[0m19:59:18.640701 [debug] [ThreadPool]: On list_airflow: Close
[0m19:59:18.645740 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_staging)
[0m19:59:18.655568 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging"
[0m19:59:18.656961 [debug] [ThreadPool]: On list_airflow_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "connection_name": "list_airflow_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m19:59:18.658503 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:59:18.684912 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.026 seconds
[0m19:59:18.688592 [debug] [ThreadPool]: On list_airflow_staging: ROLLBACK
[0m19:59:18.690217 [debug] [ThreadPool]: On list_airflow_staging: Close
[0m19:59:18.702116 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:18.703742 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:59:18.705347 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:59:18.733439 [debug] [MainThread]: SQL status: SELECT 2 in 0.028 seconds
[0m19:59:18.736957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54b5d6cc-fb07-4632-b8d6-33e8ed17bbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d8e8d8c950>]}
[0m19:59:18.738272 [debug] [MainThread]: On master: ROLLBACK
[0m19:59:18.739408 [debug] [MainThread]: On master: COMMIT
[0m19:59:18.740735 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:18.742232 [debug] [MainThread]: On master: COMMIT
[0m19:59:18.745269 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:59:18.746713 [debug] [MainThread]: On master: Close
[0m19:59:18.758268 [debug] [Thread-1 (]: Began running node model.final_project.stg_manufacturers
[0m19:59:18.759174 [debug] [Thread-2 (]: Began running node model.final_project.stg_vehicle_types
[0m19:59:18.760952 [info ] [Thread-1 (]: 1 of 3 START sql view model staging.stg_manufacturers .......................... [RUN]
[0m19:59:18.763048 [info ] [Thread-2 (]: 2 of 3 START sql view model staging.stg_vehicle_types .......................... [RUN]
[0m19:59:18.764524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging, now model.final_project.stg_manufacturers)
[0m19:59:18.765935 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.final_project.stg_vehicle_types'
[0m19:59:18.767112 [debug] [Thread-1 (]: Began compiling node model.final_project.stg_manufacturers
[0m19:59:18.768304 [debug] [Thread-2 (]: Began compiling node model.final_project.stg_vehicle_types
[0m19:59:18.784164 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.stg_manufacturers"
[0m19:59:18.789621 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.stg_vehicle_types"
[0m19:59:18.806388 [debug] [Thread-2 (]: Began executing node model.final_project.stg_vehicle_types
[0m19:59:18.821690 [debug] [Thread-1 (]: Began executing node model.final_project.stg_manufacturers
[0m19:59:18.930747 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.stg_manufacturers"
[0m19:59:18.931989 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.stg_vehicle_types"
[0m19:59:18.946880 [debug] [Thread-1 (]: Using postgres connection "model.final_project.stg_manufacturers"
[0m19:59:18.948334 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_manufacturers"} */

  create view "airflow"."staging"."stg_manufacturers__dbt_tmp"
    
    
  as (
    select
    mfr_id,
    upper(trim(mfr_name)) as mfr_name,
    upper(country) as country,
    ingested_at
from "airflow"."raw"."manufacturers"
  );
[0m19:59:18.949753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:59:18.953440 [debug] [Thread-2 (]: Using postgres connection "model.final_project.stg_vehicle_types"
[0m19:59:18.954969 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_vehicle_types"} */

  create view "airflow"."staging"."stg_vehicle_types__dbt_tmp"
    
    
  as (
    select
    mfr_id,
    vehicle_type,
    ingested_at
from "airflow"."raw"."vehicle_types"
  );
[0m19:59:18.956507 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:59:18.989096 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.032 seconds
[0m19:59:18.990773 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.041 seconds
[0m19:59:19.012056 [debug] [Thread-2 (]: Using postgres connection "model.final_project.stg_vehicle_types"
[0m19:59:19.015418 [debug] [Thread-1 (]: Using postgres connection "model.final_project.stg_manufacturers"
[0m19:59:19.016602 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_vehicle_types"} */
alter table "airflow"."staging"."stg_vehicle_types" rename to "stg_vehicle_types__dbt_backup"
[0m19:59:19.018224 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_manufacturers"} */
alter table "airflow"."staging"."stg_manufacturers" rename to "stg_manufacturers__dbt_backup"
[0m19:59:19.022740 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m19:59:19.030221 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m19:59:19.029537 [debug] [Thread-2 (]: Using postgres connection "model.final_project.stg_vehicle_types"
[0m19:59:19.037259 [debug] [Thread-1 (]: Using postgres connection "model.final_project.stg_manufacturers"
[0m19:59:19.038330 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_vehicle_types"} */
alter table "airflow"."staging"."stg_vehicle_types__dbt_tmp" rename to "stg_vehicle_types"
[0m19:59:19.039556 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_manufacturers"} */
alter table "airflow"."staging"."stg_manufacturers__dbt_tmp" rename to "stg_manufacturers"
[0m19:59:19.041860 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:59:19.049006 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m19:59:19.102359 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: COMMIT
[0m19:59:19.105917 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: COMMIT
[0m19:59:19.107094 [debug] [Thread-1 (]: Using postgres connection "model.final_project.stg_manufacturers"
[0m19:59:19.109048 [debug] [Thread-2 (]: Using postgres connection "model.final_project.stg_vehicle_types"
[0m19:59:19.110894 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: COMMIT
[0m19:59:19.112514 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: COMMIT
[0m19:59:19.118384 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m19:59:19.119480 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m19:59:19.137118 [debug] [Thread-1 (]: Applying DROP to: "airflow"."staging"."stg_manufacturers__dbt_backup"
[0m19:59:19.140714 [debug] [Thread-2 (]: Applying DROP to: "airflow"."staging"."stg_vehicle_types__dbt_backup"
[0m19:59:19.153927 [debug] [Thread-2 (]: Using postgres connection "model.final_project.stg_vehicle_types"
[0m19:59:19.155274 [debug] [Thread-1 (]: Using postgres connection "model.final_project.stg_manufacturers"
[0m19:59:19.156427 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_vehicle_types"} */
drop view if exists "airflow"."staging"."stg_vehicle_types__dbt_backup" cascade
[0m19:59:19.157926 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_manufacturers"} */
drop view if exists "airflow"."staging"."stg_manufacturers__dbt_backup" cascade
[0m19:59:19.176989 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.012 seconds
[0m19:59:19.178564 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.019 seconds
[0m19:59:19.183529 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: Close
[0m19:59:19.187242 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: Close
[0m19:59:19.191656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54b5d6cc-fb07-4632-b8d6-33e8ed17bbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d8ec0c5250>]}
[0m19:59:19.193532 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54b5d6cc-fb07-4632-b8d6-33e8ed17bbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d8e69346e0>]}
[0m19:59:19.197236 [info ] [Thread-1 (]: 1 of 3 OK created sql view model staging.stg_manufacturers ..................... [[32mCREATE VIEW[0m in 0.42s]
[0m19:59:19.199641 [info ] [Thread-2 (]: 2 of 3 OK created sql view model staging.stg_vehicle_types ..................... [[32mCREATE VIEW[0m in 0.43s]
[0m19:59:19.201350 [debug] [Thread-1 (]: Finished running node model.final_project.stg_manufacturers
[0m19:59:19.202807 [debug] [Thread-2 (]: Finished running node model.final_project.stg_vehicle_types
[0m19:59:19.205344 [debug] [Thread-1 (]: Began running node model.final_project.manufacturers_by_country
[0m19:59:19.206746 [info ] [Thread-1 (]: 3 of 3 START sql table model staging.manufacturers_by_country .................. [RUN]
[0m19:59:19.208204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.final_project.stg_manufacturers, now model.final_project.manufacturers_by_country)
[0m19:59:19.209818 [debug] [Thread-1 (]: Began compiling node model.final_project.manufacturers_by_country
[0m19:59:19.215516 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.manufacturers_by_country"
[0m19:59:19.233681 [debug] [Thread-1 (]: Began executing node model.final_project.manufacturers_by_country
[0m19:59:19.267010 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.manufacturers_by_country"
[0m19:59:19.285723 [debug] [Thread-1 (]: Using postgres connection "model.final_project.manufacturers_by_country"
[0m19:59:19.287042 [debug] [Thread-1 (]: On model.final_project.manufacturers_by_country: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.manufacturers_by_country"} */

  
    

  create  table "airflow"."staging"."manufacturers_by_country__dbt_tmp"
  
  
    as
  
  (
    select
    country,
    count(distinct mfr_id) as manufacturers_cnt
from "airflow"."staging"."stg_manufacturers"
group by country
  );
  
[0m19:59:19.288459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:59:19.320817 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.032 seconds
[0m19:59:19.334288 [debug] [Thread-1 (]: Using postgres connection "model.final_project.manufacturers_by_country"
[0m19:59:19.335508 [debug] [Thread-1 (]: On model.final_project.manufacturers_by_country: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.manufacturers_by_country"} */
alter table "airflow"."staging"."manufacturers_by_country" rename to "manufacturers_by_country__dbt_backup"
[0m19:59:19.337413 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:59:19.343161 [debug] [Thread-1 (]: Using postgres connection "model.final_project.manufacturers_by_country"
[0m19:59:19.344590 [debug] [Thread-1 (]: On model.final_project.manufacturers_by_country: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.manufacturers_by_country"} */
alter table "airflow"."staging"."manufacturers_by_country__dbt_tmp" rename to "manufacturers_by_country"
[0m19:59:19.346783 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:59:19.351047 [debug] [Thread-1 (]: On model.final_project.manufacturers_by_country: COMMIT
[0m19:59:19.353010 [debug] [Thread-1 (]: Using postgres connection "model.final_project.manufacturers_by_country"
[0m19:59:19.355536 [debug] [Thread-1 (]: On model.final_project.manufacturers_by_country: COMMIT
[0m19:59:19.360976 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m19:59:19.366172 [debug] [Thread-1 (]: Applying DROP to: "airflow"."staging"."manufacturers_by_country__dbt_backup"
[0m19:59:19.373198 [debug] [Thread-1 (]: Using postgres connection "model.final_project.manufacturers_by_country"
[0m19:59:19.374538 [debug] [Thread-1 (]: On model.final_project.manufacturers_by_country: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.manufacturers_by_country"} */
drop table if exists "airflow"."staging"."manufacturers_by_country__dbt_backup" cascade
[0m19:59:19.390547 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.015 seconds
[0m19:59:19.394240 [debug] [Thread-1 (]: On model.final_project.manufacturers_by_country: Close
[0m19:59:19.396323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54b5d6cc-fb07-4632-b8d6-33e8ed17bbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d8e8168590>]}
[0m19:59:19.398157 [info ] [Thread-1 (]: 3 of 3 OK created sql table model staging.manufacturers_by_country ............. [[32mSELECT 11[0m in 0.19s]
[0m19:59:19.399781 [debug] [Thread-1 (]: Finished running node model.final_project.manufacturers_by_country
[0m19:59:19.403197 [debug] [MainThread]: On master: COMMIT
[0m19:59:19.404429 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:19.405643 [debug] [MainThread]: On master: COMMIT
[0m19:59:19.406826 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:59:19.419669 [debug] [MainThread]: SQL status: COMMIT in 0.013 seconds
[0m19:59:19.421050 [debug] [MainThread]: On master: Close
[0m19:59:19.422687 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:59:19.423906 [debug] [MainThread]: Connection 'model.final_project.manufacturers_by_country' was properly closed.
[0m19:59:19.425151 [debug] [MainThread]: Connection 'model.final_project.stg_vehicle_types' was properly closed.
[0m19:59:19.427123 [info ] [MainThread]: 
[0m19:59:19.428636 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m19:59:19.431021 [debug] [MainThread]: Command end result
[0m19:59:19.496482 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:59:19.509830 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:59:19.528275 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m19:59:19.529422 [info ] [MainThread]: 
[0m19:59:19.530957 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:59:19.532602 [info ] [MainThread]: 
[0m19:59:19.534138 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m19:59:19.537558 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.2484047, "process_in_blocks": "0", "process_kernel_time": 1.55088, "process_mem_max_rss": "130016", "process_out_blocks": "2984", "process_user_time": 5.908495}
[0m19:59:19.539253 [debug] [MainThread]: Command `dbt run` succeeded at 19:59:19.538954 after 3.25 seconds
[0m19:59:19.540691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d8ea58c890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d8ec0c5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d8e9104d10>]}
[0m19:59:19.541937 [debug] [MainThread]: Flushing usage events
[0m19:59:20.591892 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:59:33.804600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7625c7353c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7625c9a4c1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7625c7705250>]}


============================== 19:59:33.818510 | 2085d4df-57d9-4f4d-8ad6-79b05a73eff7 ==============================
[0m19:59:33.818510 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:59:33.820993 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'fail_fast': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'version_check': 'True', 'debug': 'False', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'no_print': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/dbt/logs', 'write_json': 'True', 'profiles_dir': '/opt/airflow/dbt', 'introspect': 'True', 'printer_width': '80', 'use_colors': 'True'}
[0m19:59:34.105231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2085d4df-57d9-4f4d-8ad6-79b05a73eff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7625c7a950d0>]}
[0m19:59:34.201372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2085d4df-57d9-4f4d-8ad6-79b05a73eff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7625c7ea7680>]}
[0m19:59:34.203053 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m19:59:34.389966 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:59:34.799628 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:59:34.801198 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:59:34.802565 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:59:34.934445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2085d4df-57d9-4f4d-8ad6-79b05a73eff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7625c5b35310>]}
[0m19:59:35.368233 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:59:35.385801 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:59:35.518087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2085d4df-57d9-4f4d-8ad6-79b05a73eff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7625c4f3d370>]}
[0m19:59:35.520568 [info ] [MainThread]: Found 3 models, 4 data tests, 2 sources, 463 macros
[0m19:59:35.522386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2085d4df-57d9-4f4d-8ad6-79b05a73eff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7625c57798e0>]}
[0m19:59:35.530122 [info ] [MainThread]: 
[0m19:59:35.532798 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:59:35.537919 [info ] [MainThread]: 
[0m19:59:35.540669 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:59:35.556078 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m19:59:35.671830 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m19:59:35.673122 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m19:59:35.674274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:35.699952 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.024 seconds
[0m19:59:35.706439 [debug] [ThreadPool]: On list_airflow: Close
[0m19:59:35.729827 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_staging)
[0m19:59:35.758075 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging"
[0m19:59:35.760425 [debug] [ThreadPool]: On list_airflow_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "connection_name": "list_airflow_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m19:59:35.762734 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:59:35.792744 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.030 seconds
[0m19:59:35.797967 [debug] [ThreadPool]: On list_airflow_staging: ROLLBACK
[0m19:59:35.799953 [debug] [ThreadPool]: On list_airflow_staging: Close
[0m19:59:35.841174 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:35.844699 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:59:35.849040 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:59:35.933320 [debug] [MainThread]: SQL status: SELECT 2 in 0.084 seconds
[0m19:59:35.938161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2085d4df-57d9-4f4d-8ad6-79b05a73eff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7625c968d160>]}
[0m19:59:35.941061 [debug] [MainThread]: On master: ROLLBACK
[0m19:59:35.943255 [debug] [MainThread]: On master: COMMIT
[0m19:59:35.944749 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:35.948278 [debug] [MainThread]: On master: COMMIT
[0m19:59:35.950534 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:59:35.952659 [debug] [MainThread]: On master: Close
[0m19:59:35.970243 [debug] [Thread-1 (]: Began running node model.final_project.stg_manufacturers
[0m19:59:35.971891 [debug] [Thread-2 (]: Began running node model.final_project.stg_vehicle_types
[0m19:59:35.973708 [info ] [Thread-1 (]: 1 of 3 START sql view model staging.stg_manufacturers .......................... [RUN]
[0m19:59:35.976519 [info ] [Thread-2 (]: 2 of 3 START sql view model staging.stg_vehicle_types .......................... [RUN]
[0m19:59:35.980124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging, now model.final_project.stg_manufacturers)
[0m19:59:35.982599 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.final_project.stg_vehicle_types'
[0m19:59:35.984624 [debug] [Thread-1 (]: Began compiling node model.final_project.stg_manufacturers
[0m19:59:35.986563 [debug] [Thread-2 (]: Began compiling node model.final_project.stg_vehicle_types
[0m19:59:36.011835 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.stg_vehicle_types"
[0m19:59:36.013236 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.stg_manufacturers"
[0m19:59:36.030823 [debug] [Thread-2 (]: Began executing node model.final_project.stg_vehicle_types
[0m19:59:36.039723 [debug] [Thread-1 (]: Began executing node model.final_project.stg_manufacturers
[0m19:59:36.183524 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.stg_manufacturers"
[0m19:59:36.186828 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.stg_vehicle_types"
[0m19:59:36.201003 [debug] [Thread-2 (]: Using postgres connection "model.final_project.stg_vehicle_types"
[0m19:59:36.202864 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_vehicle_types"} */

  create view "airflow"."staging"."stg_vehicle_types__dbt_tmp"
    
    
  as (
    select
    mfr_id,
    vehicle_type,
    ingested_at
from "airflow"."raw"."vehicle_types"
  );
[0m19:59:36.204374 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:59:36.205301 [debug] [Thread-1 (]: Using postgres connection "model.final_project.stg_manufacturers"
[0m19:59:36.206859 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_manufacturers"} */

  create view "airflow"."staging"."stg_manufacturers__dbt_tmp"
    
    
  as (
    select
    mfr_id,
    upper(trim(mfr_name)) as mfr_name,
    upper(country) as country,
    ingested_at
from "airflow"."raw"."manufacturers"
  );
[0m19:59:36.209442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:59:36.221911 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m19:59:36.232764 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.024 seconds
[0m19:59:36.237785 [debug] [Thread-2 (]: Using postgres connection "model.final_project.stg_vehicle_types"
[0m19:59:36.246728 [debug] [Thread-1 (]: Using postgres connection "model.final_project.stg_manufacturers"
[0m19:59:36.248584 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_vehicle_types"} */
alter table "airflow"."staging"."stg_vehicle_types" rename to "stg_vehicle_types__dbt_backup"
[0m19:59:36.250228 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_manufacturers"} */
alter table "airflow"."staging"."stg_manufacturers" rename to "stg_manufacturers__dbt_backup"
[0m19:59:36.253504 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:59:36.254589 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:59:36.261345 [debug] [Thread-2 (]: Using postgres connection "model.final_project.stg_vehicle_types"
[0m19:59:36.268379 [debug] [Thread-1 (]: Using postgres connection "model.final_project.stg_manufacturers"
[0m19:59:36.269221 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_vehicle_types"} */
alter table "airflow"."staging"."stg_vehicle_types__dbt_tmp" rename to "stg_vehicle_types"
[0m19:59:36.270494 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_manufacturers"} */
alter table "airflow"."staging"."stg_manufacturers__dbt_tmp" rename to "stg_manufacturers"
[0m19:59:36.273812 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:59:36.274862 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m19:59:36.340671 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: COMMIT
[0m19:59:36.346446 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: COMMIT
[0m19:59:36.347639 [debug] [Thread-1 (]: Using postgres connection "model.final_project.stg_manufacturers"
[0m19:59:36.349341 [debug] [Thread-2 (]: Using postgres connection "model.final_project.stg_vehicle_types"
[0m19:59:36.350854 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: COMMIT
[0m19:59:36.352159 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: COMMIT
[0m19:59:36.355863 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:59:36.357207 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m19:59:36.375418 [debug] [Thread-1 (]: Applying DROP to: "airflow"."staging"."stg_manufacturers__dbt_backup"
[0m19:59:36.380174 [debug] [Thread-2 (]: Applying DROP to: "airflow"."staging"."stg_vehicle_types__dbt_backup"
[0m19:59:36.398150 [debug] [Thread-2 (]: Using postgres connection "model.final_project.stg_vehicle_types"
[0m19:59:36.402892 [debug] [Thread-1 (]: Using postgres connection "model.final_project.stg_manufacturers"
[0m19:59:36.403954 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_vehicle_types"} */
drop view if exists "airflow"."staging"."stg_vehicle_types__dbt_backup" cascade
[0m19:59:36.405866 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_manufacturers"} */
drop view if exists "airflow"."staging"."stg_manufacturers__dbt_backup" cascade
[0m19:59:36.411668 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m19:59:36.413209 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m19:59:36.418508 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: Close
[0m19:59:36.422436 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: Close
[0m19:59:36.430454 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2085d4df-57d9-4f4d-8ad6-79b05a73eff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7625c5732b40>]}
[0m19:59:36.431642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2085d4df-57d9-4f4d-8ad6-79b05a73eff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7625c6aa8d70>]}
[0m19:59:36.434119 [info ] [Thread-2 (]: 2 of 3 OK created sql view model staging.stg_vehicle_types ..................... [[32mCREATE VIEW[0m in 0.44s]
[0m19:59:36.436194 [info ] [Thread-1 (]: 1 of 3 OK created sql view model staging.stg_manufacturers ..................... [[32mCREATE VIEW[0m in 0.45s]
[0m19:59:36.438149 [debug] [Thread-2 (]: Finished running node model.final_project.stg_vehicle_types
[0m19:59:36.439904 [debug] [Thread-1 (]: Finished running node model.final_project.stg_manufacturers
[0m19:59:36.444130 [debug] [Thread-2 (]: Began running node model.final_project.manufacturers_by_country
[0m19:59:36.445737 [info ] [Thread-2 (]: 3 of 3 START sql table model staging.manufacturers_by_country .................. [RUN]
[0m19:59:36.447274 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.final_project.stg_vehicle_types, now model.final_project.manufacturers_by_country)
[0m19:59:36.448600 [debug] [Thread-2 (]: Began compiling node model.final_project.manufacturers_by_country
[0m19:59:36.454587 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.manufacturers_by_country"
[0m19:59:36.482432 [debug] [Thread-2 (]: Began executing node model.final_project.manufacturers_by_country
[0m19:59:36.529205 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.manufacturers_by_country"
[0m19:59:36.550465 [debug] [Thread-2 (]: Using postgres connection "model.final_project.manufacturers_by_country"
[0m19:59:36.552311 [debug] [Thread-2 (]: On model.final_project.manufacturers_by_country: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.manufacturers_by_country"} */

  
    

  create  table "airflow"."staging"."manufacturers_by_country__dbt_tmp"
  
  
    as
  
  (
    select
    country,
    count(distinct mfr_id) as manufacturers_cnt
from "airflow"."staging"."stg_manufacturers"
group by country
  );
  
[0m19:59:36.553852 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:59:36.579332 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.025 seconds
[0m19:59:36.594534 [debug] [Thread-2 (]: Using postgres connection "model.final_project.manufacturers_by_country"
[0m19:59:36.596176 [debug] [Thread-2 (]: On model.final_project.manufacturers_by_country: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.manufacturers_by_country"} */
alter table "airflow"."staging"."manufacturers_by_country" rename to "manufacturers_by_country__dbt_backup"
[0m19:59:36.599025 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:59:36.605957 [debug] [Thread-2 (]: Using postgres connection "model.final_project.manufacturers_by_country"
[0m19:59:36.607528 [debug] [Thread-2 (]: On model.final_project.manufacturers_by_country: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.manufacturers_by_country"} */
alter table "airflow"."staging"."manufacturers_by_country__dbt_tmp" rename to "manufacturers_by_country"
[0m19:59:36.610935 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:59:36.615641 [debug] [Thread-2 (]: On model.final_project.manufacturers_by_country: COMMIT
[0m19:59:36.617210 [debug] [Thread-2 (]: Using postgres connection "model.final_project.manufacturers_by_country"
[0m19:59:36.619829 [debug] [Thread-2 (]: On model.final_project.manufacturers_by_country: COMMIT
[0m19:59:36.624389 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m19:59:36.631630 [debug] [Thread-2 (]: Applying DROP to: "airflow"."staging"."manufacturers_by_country__dbt_backup"
[0m19:59:36.639322 [debug] [Thread-2 (]: Using postgres connection "model.final_project.manufacturers_by_country"
[0m19:59:36.641041 [debug] [Thread-2 (]: On model.final_project.manufacturers_by_country: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.manufacturers_by_country"} */
drop table if exists "airflow"."staging"."manufacturers_by_country__dbt_backup" cascade
[0m19:59:36.647641 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m19:59:36.651437 [debug] [Thread-2 (]: On model.final_project.manufacturers_by_country: Close
[0m19:59:36.653350 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2085d4df-57d9-4f4d-8ad6-79b05a73eff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7625c3dfab40>]}
[0m19:59:36.655378 [info ] [Thread-2 (]: 3 of 3 OK created sql table model staging.manufacturers_by_country ............. [[32mSELECT 11[0m in 0.21s]
[0m19:59:36.657702 [debug] [Thread-2 (]: Finished running node model.final_project.manufacturers_by_country
[0m19:59:36.662603 [debug] [MainThread]: On master: COMMIT
[0m19:59:36.663940 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:36.665504 [debug] [MainThread]: On master: COMMIT
[0m19:59:36.666907 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:59:36.680543 [debug] [MainThread]: SQL status: COMMIT in 0.014 seconds
[0m19:59:36.682311 [debug] [MainThread]: On master: Close
[0m19:59:36.684176 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:59:36.685281 [debug] [MainThread]: Connection 'model.final_project.stg_manufacturers' was properly closed.
[0m19:59:36.686337 [debug] [MainThread]: Connection 'model.final_project.manufacturers_by_country' was properly closed.
[0m19:59:36.687508 [info ] [MainThread]: 
[0m19:59:36.689039 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 1.15 seconds (1.15s).
[0m19:59:36.691534 [debug] [MainThread]: Command end result
[0m19:59:36.781769 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:59:36.799259 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:59:36.822496 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m19:59:36.823898 [info ] [MainThread]: 
[0m19:59:36.826352 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:59:36.828590 [info ] [MainThread]: 
[0m19:59:36.830780 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m19:59:36.833936 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.1761878, "process_in_blocks": "0", "process_kernel_time": 1.007982, "process_mem_max_rss": "129368", "process_out_blocks": "0", "process_user_time": 5.529959}
[0m19:59:36.835777 [debug] [MainThread]: Command `dbt run` succeeded at 19:59:36.835515 after 3.18 seconds
[0m19:59:36.837022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7625c8b4f470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7625c7704f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7625c6eed280>]}
[0m19:59:36.838562 [debug] [MainThread]: Flushing usage events
[0m19:59:37.654544 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:59:50.829114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f700298ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70018a6a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70018faae0>]}


============================== 19:59:50.843323 | 4423c57c-18d5-4d6b-88d6-ef47e68672cd ==============================
[0m19:59:50.843323 [info ] [MainThread]: Running with dbt=1.11.2
[0m19:59:50.844679 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'indirect_selection': 'eager', 'quiet': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'empty': 'False', 'target_path': 'None', 'warn_error': 'None', 'introspect': 'True', 'log_path': '/opt/airflow/dbt/logs', 'log_cache_events': 'False', 'debug': 'False', 'invocation_command': 'dbt run', 'no_print': 'None', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'version_check': 'True', 'fail_fast': 'False', 'partial_parse': 'True'}
[0m19:59:51.121834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4423c57c-18d5-4d6b-88d6-ef47e68672cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7000cab380>]}
[0m19:59:51.222232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4423c57c-18d5-4d6b-88d6-ef47e68672cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7000d3ac00>]}
[0m19:59:51.224227 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m19:59:51.417841 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m19:59:51.949349 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:59:51.950860 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m19:59:51.952014 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:59:52.045064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4423c57c-18d5-4d6b-88d6-ef47e68672cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fffd4cad0>]}
[0m19:59:52.200996 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:59:52.215050 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:59:52.266920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4423c57c-18d5-4d6b-88d6-ef47e68672cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fff1661e0>]}
[0m19:59:52.268986 [info ] [MainThread]: Found 3 models, 4 data tests, 2 sources, 463 macros
[0m19:59:52.271370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4423c57c-18d5-4d6b-88d6-ef47e68672cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fffd4d880>]}
[0m19:59:52.276534 [info ] [MainThread]: 
[0m19:59:52.278332 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:59:52.279923 [info ] [MainThread]: 
[0m19:59:52.281647 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:59:52.289085 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m19:59:52.367842 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m19:59:52.369132 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m19:59:52.370474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:52.389260 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.019 seconds
[0m19:59:52.391837 [debug] [ThreadPool]: On list_airflow: Close
[0m19:59:52.395773 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_staging)
[0m19:59:52.406160 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging"
[0m19:59:52.407555 [debug] [ThreadPool]: On list_airflow_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "connection_name": "list_airflow_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m19:59:52.409257 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:59:52.433559 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.024 seconds
[0m19:59:52.437302 [debug] [ThreadPool]: On list_airflow_staging: ROLLBACK
[0m19:59:52.439085 [debug] [ThreadPool]: On list_airflow_staging: Close
[0m19:59:52.449264 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:52.450465 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:59:52.451520 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:59:52.473644 [debug] [MainThread]: SQL status: SELECT 2 in 0.022 seconds
[0m19:59:52.476809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4423c57c-18d5-4d6b-88d6-ef47e68672cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fffd22720>]}
[0m19:59:52.478317 [debug] [MainThread]: On master: ROLLBACK
[0m19:59:52.479627 [debug] [MainThread]: On master: COMMIT
[0m19:59:52.480538 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:52.481404 [debug] [MainThread]: On master: COMMIT
[0m19:59:52.482687 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:59:52.483542 [debug] [MainThread]: On master: Close
[0m19:59:52.493234 [debug] [Thread-1 (]: Began running node model.final_project.stg_manufacturers
[0m19:59:52.494260 [debug] [Thread-2 (]: Began running node model.final_project.stg_vehicle_types
[0m19:59:52.495489 [info ] [Thread-1 (]: 1 of 3 START sql view model staging.stg_manufacturers .......................... [RUN]
[0m19:59:52.497444 [info ] [Thread-2 (]: 2 of 3 START sql view model staging.stg_vehicle_types .......................... [RUN]
[0m19:59:52.498758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging, now model.final_project.stg_manufacturers)
[0m19:59:52.500556 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.final_project.stg_vehicle_types'
[0m19:59:52.501848 [debug] [Thread-1 (]: Began compiling node model.final_project.stg_manufacturers
[0m19:59:52.502931 [debug] [Thread-2 (]: Began compiling node model.final_project.stg_vehicle_types
[0m19:59:52.514307 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.stg_manufacturers"
[0m19:59:52.521416 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.stg_vehicle_types"
[0m19:59:52.534528 [debug] [Thread-2 (]: Began executing node model.final_project.stg_vehicle_types
[0m19:59:52.542065 [debug] [Thread-1 (]: Began executing node model.final_project.stg_manufacturers
[0m19:59:52.659962 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.stg_manufacturers"
[0m19:59:52.665681 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.stg_vehicle_types"
[0m19:59:52.680577 [debug] [Thread-1 (]: Using postgres connection "model.final_project.stg_manufacturers"
[0m19:59:52.682880 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_manufacturers"} */

  create view "airflow"."staging"."stg_manufacturers__dbt_tmp"
    
    
  as (
    select
    mfr_id,
    upper(trim(mfr_name)) as mfr_name,
    upper(country) as country,
    ingested_at
from "airflow"."raw"."manufacturers"
  );
[0m19:59:52.685194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:59:52.686220 [debug] [Thread-2 (]: Using postgres connection "model.final_project.stg_vehicle_types"
[0m19:59:52.688306 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_vehicle_types"} */

  create view "airflow"."staging"."stg_vehicle_types__dbt_tmp"
    
    
  as (
    select
    mfr_id,
    vehicle_type,
    ingested_at
from "airflow"."raw"."vehicle_types"
  );
[0m19:59:52.689955 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:59:52.702805 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m19:59:52.714345 [debug] [Thread-1 (]: Using postgres connection "model.final_project.stg_manufacturers"
[0m19:59:52.715448 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.025 seconds
[0m19:59:52.716480 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_manufacturers"} */
alter table "airflow"."staging"."stg_manufacturers" rename to "stg_manufacturers__dbt_backup"
[0m19:59:52.722976 [debug] [Thread-2 (]: Using postgres connection "model.final_project.stg_vehicle_types"
[0m19:59:52.724551 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_vehicle_types"} */
alter table "airflow"."staging"."stg_vehicle_types" rename to "stg_vehicle_types__dbt_backup"
[0m19:59:52.725677 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:59:52.731148 [debug] [Thread-1 (]: Using postgres connection "model.final_project.stg_manufacturers"
[0m19:59:52.732129 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m19:59:52.733258 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_manufacturers"} */
alter table "airflow"."staging"."stg_manufacturers__dbt_tmp" rename to "stg_manufacturers"
[0m19:59:52.740321 [debug] [Thread-2 (]: Using postgres connection "model.final_project.stg_vehicle_types"
[0m19:59:52.741865 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_vehicle_types"} */
alter table "airflow"."staging"."stg_vehicle_types__dbt_tmp" rename to "stg_vehicle_types"
[0m19:59:52.742608 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:59:52.755043 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m19:59:52.791361 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: COMMIT
[0m19:59:52.792444 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: COMMIT
[0m19:59:52.793203 [debug] [Thread-1 (]: Using postgres connection "model.final_project.stg_manufacturers"
[0m19:59:52.794546 [debug] [Thread-2 (]: Using postgres connection "model.final_project.stg_vehicle_types"
[0m19:59:52.795744 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: COMMIT
[0m19:59:52.796969 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: COMMIT
[0m19:59:52.800694 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:59:52.801779 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m19:59:52.811623 [debug] [Thread-1 (]: Applying DROP to: "airflow"."staging"."stg_manufacturers__dbt_backup"
[0m19:59:52.818160 [debug] [Thread-2 (]: Applying DROP to: "airflow"."staging"."stg_vehicle_types__dbt_backup"
[0m19:59:52.827625 [debug] [Thread-1 (]: Using postgres connection "model.final_project.stg_manufacturers"
[0m19:59:52.830171 [debug] [Thread-2 (]: Using postgres connection "model.final_project.stg_vehicle_types"
[0m19:59:52.831626 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_manufacturers"} */
drop view if exists "airflow"."staging"."stg_manufacturers__dbt_backup" cascade
[0m19:59:52.832861 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_vehicle_types"} */
drop view if exists "airflow"."staging"."stg_vehicle_types__dbt_backup" cascade
[0m19:59:52.837265 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m19:59:52.838113 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m19:59:52.842032 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: Close
[0m19:59:52.845606 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: Close
[0m19:59:52.851493 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4423c57c-18d5-4d6b-88d6-ef47e68672cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7003775130>]}
[0m19:59:52.852582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4423c57c-18d5-4d6b-88d6-ef47e68672cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fff12c710>]}
[0m19:59:52.854257 [info ] [Thread-2 (]: 2 of 3 OK created sql view model staging.stg_vehicle_types ..................... [[32mCREATE VIEW[0m in 0.35s]
[0m19:59:52.856319 [info ] [Thread-1 (]: 1 of 3 OK created sql view model staging.stg_manufacturers ..................... [[32mCREATE VIEW[0m in 0.35s]
[0m19:59:52.858002 [debug] [Thread-2 (]: Finished running node model.final_project.stg_vehicle_types
[0m19:59:52.859586 [debug] [Thread-1 (]: Finished running node model.final_project.stg_manufacturers
[0m19:59:52.862932 [debug] [Thread-2 (]: Began running node model.final_project.manufacturers_by_country
[0m19:59:52.864352 [info ] [Thread-2 (]: 3 of 3 START sql table model staging.manufacturers_by_country .................. [RUN]
[0m19:59:52.865584 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.final_project.stg_vehicle_types, now model.final_project.manufacturers_by_country)
[0m19:59:52.866616 [debug] [Thread-2 (]: Began compiling node model.final_project.manufacturers_by_country
[0m19:59:52.871410 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.manufacturers_by_country"
[0m19:59:52.885452 [debug] [Thread-2 (]: Began executing node model.final_project.manufacturers_by_country
[0m19:59:52.916054 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.manufacturers_by_country"
[0m19:59:52.933404 [debug] [Thread-2 (]: Using postgres connection "model.final_project.manufacturers_by_country"
[0m19:59:52.934885 [debug] [Thread-2 (]: On model.final_project.manufacturers_by_country: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.manufacturers_by_country"} */

  
    

  create  table "airflow"."staging"."manufacturers_by_country__dbt_tmp"
  
  
    as
  
  (
    select
    country,
    count(distinct mfr_id) as manufacturers_cnt
from "airflow"."staging"."stg_manufacturers"
group by country
  );
  
[0m19:59:52.936089 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:59:52.956543 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.020 seconds
[0m19:59:52.970851 [debug] [Thread-2 (]: Using postgres connection "model.final_project.manufacturers_by_country"
[0m19:59:52.972165 [debug] [Thread-2 (]: On model.final_project.manufacturers_by_country: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.manufacturers_by_country"} */
alter table "airflow"."staging"."manufacturers_by_country" rename to "manufacturers_by_country__dbt_backup"
[0m19:59:52.974715 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:59:52.980471 [debug] [Thread-2 (]: Using postgres connection "model.final_project.manufacturers_by_country"
[0m19:59:52.981784 [debug] [Thread-2 (]: On model.final_project.manufacturers_by_country: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.manufacturers_by_country"} */
alter table "airflow"."staging"."manufacturers_by_country__dbt_tmp" rename to "manufacturers_by_country"
[0m19:59:52.983924 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:59:52.987882 [debug] [Thread-2 (]: On model.final_project.manufacturers_by_country: COMMIT
[0m19:59:52.989503 [debug] [Thread-2 (]: Using postgres connection "model.final_project.manufacturers_by_country"
[0m19:59:52.991035 [debug] [Thread-2 (]: On model.final_project.manufacturers_by_country: COMMIT
[0m19:59:52.994907 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m19:59:53.001140 [debug] [Thread-2 (]: Applying DROP to: "airflow"."staging"."manufacturers_by_country__dbt_backup"
[0m19:59:53.008293 [debug] [Thread-2 (]: Using postgres connection "model.final_project.manufacturers_by_country"
[0m19:59:53.009670 [debug] [Thread-2 (]: On model.final_project.manufacturers_by_country: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.manufacturers_by_country"} */
drop table if exists "airflow"."staging"."manufacturers_by_country__dbt_backup" cascade
[0m19:59:53.015993 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.005 seconds
[0m19:59:53.019872 [debug] [Thread-2 (]: On model.final_project.manufacturers_by_country: Close
[0m19:59:53.022024 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4423c57c-18d5-4d6b-88d6-ef47e68672cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ffdffa4b0>]}
[0m19:59:53.026024 [info ] [Thread-2 (]: 3 of 3 OK created sql table model staging.manufacturers_by_country ............. [[32mSELECT 11[0m in 0.16s]
[0m19:59:53.028259 [debug] [Thread-2 (]: Finished running node model.final_project.manufacturers_by_country
[0m19:59:53.031769 [debug] [MainThread]: On master: COMMIT
[0m19:59:53.033065 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:53.034089 [debug] [MainThread]: On master: COMMIT
[0m19:59:53.034985 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:59:53.049964 [debug] [MainThread]: SQL status: COMMIT in 0.015 seconds
[0m19:59:53.051265 [debug] [MainThread]: On master: Close
[0m19:59:53.052556 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:59:53.053747 [debug] [MainThread]: Connection 'model.final_project.stg_manufacturers' was properly closed.
[0m19:59:53.055220 [debug] [MainThread]: Connection 'model.final_project.manufacturers_by_country' was properly closed.
[0m19:59:53.056516 [info ] [MainThread]: 
[0m19:59:53.058061 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m19:59:53.060262 [debug] [MainThread]: Command end result
[0m19:59:53.121146 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:59:53.135266 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:59:53.154526 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m19:59:53.155640 [info ] [MainThread]: 
[0m19:59:53.157119 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:59:53.158634 [info ] [MainThread]: 
[0m19:59:53.160326 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m19:59:53.162863 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4463487, "process_in_blocks": "0", "process_kernel_time": 0.892364, "process_mem_max_rss": "129332", "process_out_blocks": "0", "process_user_time": 4.549074}
[0m19:59:53.164434 [debug] [MainThread]: Command `dbt run` succeeded at 19:59:53.164169 after 2.45 seconds
[0m19:59:53.165951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f700298ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70019bcf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7003bc8a40>]}
[0m19:59:53.167153 [debug] [MainThread]: Flushing usage events
[0m19:59:53.940352 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:00:06.980483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756c4ca91580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756c4c609280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756c4ca93b60>]}


============================== 20:00:06.998316 | 67abf515-dfd2-48f3-a824-79ebccb30c2c ==============================
[0m20:00:06.998316 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:00:07.000495 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'warn_error': 'None', 'no_print': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'debug': 'False', 'partial_parse': 'True', 'quiet': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'target_path': 'None', 'empty': 'False'}
[0m20:00:07.331180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67abf515-dfd2-48f3-a824-79ebccb30c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756c4d1d50a0>]}
[0m20:00:07.477310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67abf515-dfd2-48f3-a824-79ebccb30c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756c4ce24c20>]}
[0m20:00:07.479881 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:00:07.699562 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:00:08.164925 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:00:08.166304 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m20:00:08.167432 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:00:08.242547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67abf515-dfd2-48f3-a824-79ebccb30c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756c4bd411f0>]}
[0m20:00:08.438419 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:00:08.458329 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:00:08.515190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67abf515-dfd2-48f3-a824-79ebccb30c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756c4ad49fa0>]}
[0m20:00:08.517700 [info ] [MainThread]: Found 3 models, 4 data tests, 2 sources, 463 macros
[0m20:00:08.519560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67abf515-dfd2-48f3-a824-79ebccb30c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756c4c30b500>]}
[0m20:00:08.526397 [info ] [MainThread]: 
[0m20:00:08.528093 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:00:08.529611 [info ] [MainThread]: 
[0m20:00:08.531804 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:00:08.541340 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m20:00:08.623442 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m20:00:08.624738 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m20:00:08.626197 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:08.645284 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.019 seconds
[0m20:00:08.648783 [debug] [ThreadPool]: On list_airflow: Close
[0m20:00:08.653150 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_staging)
[0m20:00:08.663439 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging"
[0m20:00:08.664670 [debug] [ThreadPool]: On list_airflow_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "connection_name": "list_airflow_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m20:00:08.665728 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:00:08.685663 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.020 seconds
[0m20:00:08.688842 [debug] [ThreadPool]: On list_airflow_staging: ROLLBACK
[0m20:00:08.691263 [debug] [ThreadPool]: On list_airflow_staging: Close
[0m20:00:08.702616 [debug] [MainThread]: Using postgres connection "master"
[0m20:00:08.704192 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:00:08.706062 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:00:08.723679 [debug] [MainThread]: SQL status: SELECT 2 in 0.018 seconds
[0m20:00:08.727271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67abf515-dfd2-48f3-a824-79ebccb30c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756c4b905850>]}
[0m20:00:08.728627 [debug] [MainThread]: On master: ROLLBACK
[0m20:00:08.729917 [debug] [MainThread]: On master: COMMIT
[0m20:00:08.731007 [debug] [MainThread]: Using postgres connection "master"
[0m20:00:08.731821 [debug] [MainThread]: On master: COMMIT
[0m20:00:08.733229 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:00:08.734160 [debug] [MainThread]: On master: Close
[0m20:00:08.741763 [debug] [Thread-1 (]: Began running node model.final_project.stg_manufacturers
[0m20:00:08.743263 [debug] [Thread-2 (]: Began running node model.final_project.stg_vehicle_types
[0m20:00:08.744214 [info ] [Thread-1 (]: 1 of 3 START sql view model staging.stg_manufacturers .......................... [RUN]
[0m20:00:08.745464 [info ] [Thread-2 (]: 2 of 3 START sql view model staging.stg_vehicle_types .......................... [RUN]
[0m20:00:08.746871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging, now model.final_project.stg_manufacturers)
[0m20:00:08.748235 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.final_project.stg_vehicle_types'
[0m20:00:08.749382 [debug] [Thread-1 (]: Began compiling node model.final_project.stg_manufacturers
[0m20:00:08.750375 [debug] [Thread-2 (]: Began compiling node model.final_project.stg_vehicle_types
[0m20:00:08.761390 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.stg_manufacturers"
[0m20:00:08.768703 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.stg_vehicle_types"
[0m20:00:08.781974 [debug] [Thread-1 (]: Began executing node model.final_project.stg_manufacturers
[0m20:00:08.791193 [debug] [Thread-2 (]: Began executing node model.final_project.stg_vehicle_types
[0m20:00:08.903363 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.stg_manufacturers"
[0m20:00:08.904324 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.stg_vehicle_types"
[0m20:00:08.917805 [debug] [Thread-1 (]: Using postgres connection "model.final_project.stg_manufacturers"
[0m20:00:08.920226 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_manufacturers"} */

  create view "airflow"."staging"."stg_manufacturers__dbt_tmp"
    
    
  as (
    select
    mfr_id,
    upper(trim(mfr_name)) as mfr_name,
    upper(country) as country,
    ingested_at
from "airflow"."raw"."manufacturers"
  );
[0m20:00:08.922451 [debug] [Thread-2 (]: Using postgres connection "model.final_project.stg_vehicle_types"
[0m20:00:08.923498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:08.925063 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_vehicle_types"} */

  create view "airflow"."staging"."stg_vehicle_types__dbt_tmp"
    
    
  as (
    select
    mfr_id,
    vehicle_type,
    ingested_at
from "airflow"."raw"."vehicle_types"
  );
[0m20:00:08.927680 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:00:08.941214 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m20:00:08.942307 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m20:00:08.952330 [debug] [Thread-1 (]: Using postgres connection "model.final_project.stg_manufacturers"
[0m20:00:08.960963 [debug] [Thread-2 (]: Using postgres connection "model.final_project.stg_vehicle_types"
[0m20:00:08.962046 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_manufacturers"} */
alter table "airflow"."staging"."stg_manufacturers" rename to "stg_manufacturers__dbt_backup"
[0m20:00:08.963944 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_vehicle_types"} */
alter table "airflow"."staging"."stg_vehicle_types" rename to "stg_vehicle_types__dbt_backup"
[0m20:00:08.966386 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:00:08.972497 [debug] [Thread-1 (]: Using postgres connection "model.final_project.stg_manufacturers"
[0m20:00:08.973373 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m20:00:08.974581 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_manufacturers"} */
alter table "airflow"."staging"."stg_manufacturers__dbt_tmp" rename to "stg_manufacturers"
[0m20:00:08.981405 [debug] [Thread-2 (]: Using postgres connection "model.final_project.stg_vehicle_types"
[0m20:00:08.983338 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:00:08.984225 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_vehicle_types"} */
alter table "airflow"."staging"."stg_vehicle_types__dbt_tmp" rename to "stg_vehicle_types"
[0m20:00:09.003156 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m20:00:09.021729 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: COMMIT
[0m20:00:09.020517 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: COMMIT
[0m20:00:09.023644 [debug] [Thread-2 (]: Using postgres connection "model.final_project.stg_vehicle_types"
[0m20:00:09.025157 [debug] [Thread-1 (]: Using postgres connection "model.final_project.stg_manufacturers"
[0m20:00:09.026495 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: COMMIT
[0m20:00:09.027867 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: COMMIT
[0m20:00:09.031315 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m20:00:09.032427 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m20:00:09.042291 [debug] [Thread-2 (]: Applying DROP to: "airflow"."staging"."stg_vehicle_types__dbt_backup"
[0m20:00:09.047728 [debug] [Thread-1 (]: Applying DROP to: "airflow"."staging"."stg_manufacturers__dbt_backup"
[0m20:00:09.058313 [debug] [Thread-2 (]: Using postgres connection "model.final_project.stg_vehicle_types"
[0m20:00:09.060026 [debug] [Thread-1 (]: Using postgres connection "model.final_project.stg_manufacturers"
[0m20:00:09.061619 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_vehicle_types"} */
drop view if exists "airflow"."staging"."stg_vehicle_types__dbt_backup" cascade
[0m20:00:09.062903 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.stg_manufacturers"} */
drop view if exists "airflow"."staging"."stg_manufacturers__dbt_backup" cascade
[0m20:00:09.067118 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:00:09.068149 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m20:00:09.073118 [debug] [Thread-2 (]: On model.final_project.stg_vehicle_types: Close
[0m20:00:09.075914 [debug] [Thread-1 (]: On model.final_project.stg_manufacturers: Close
[0m20:00:09.079795 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67abf515-dfd2-48f3-a824-79ebccb30c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756c4952f890>]}
[0m20:00:09.081081 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67abf515-dfd2-48f3-a824-79ebccb30c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756c4b906180>]}
[0m20:00:09.083012 [info ] [Thread-2 (]: 2 of 3 OK created sql view model staging.stg_vehicle_types ..................... [[32mCREATE VIEW[0m in 0.33s]
[0m20:00:09.084748 [info ] [Thread-1 (]: 1 of 3 OK created sql view model staging.stg_manufacturers ..................... [[32mCREATE VIEW[0m in 0.33s]
[0m20:00:09.086638 [debug] [Thread-2 (]: Finished running node model.final_project.stg_vehicle_types
[0m20:00:09.088368 [debug] [Thread-1 (]: Finished running node model.final_project.stg_manufacturers
[0m20:00:09.091582 [debug] [Thread-2 (]: Began running node model.final_project.manufacturers_by_country
[0m20:00:09.093045 [info ] [Thread-2 (]: 3 of 3 START sql table model staging.manufacturers_by_country .................. [RUN]
[0m20:00:09.094518 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.final_project.stg_vehicle_types, now model.final_project.manufacturers_by_country)
[0m20:00:09.095690 [debug] [Thread-2 (]: Began compiling node model.final_project.manufacturers_by_country
[0m20:00:09.100915 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.manufacturers_by_country"
[0m20:00:09.117088 [debug] [Thread-2 (]: Began executing node model.final_project.manufacturers_by_country
[0m20:00:09.147790 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.manufacturers_by_country"
[0m20:00:09.165142 [debug] [Thread-2 (]: Using postgres connection "model.final_project.manufacturers_by_country"
[0m20:00:09.166534 [debug] [Thread-2 (]: On model.final_project.manufacturers_by_country: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.manufacturers_by_country"} */

  
    

  create  table "airflow"."staging"."manufacturers_by_country__dbt_tmp"
  
  
    as
  
  (
    select
    country,
    count(distinct mfr_id) as manufacturers_cnt
from "airflow"."staging"."stg_manufacturers"
group by country
  );
  
[0m20:00:09.167744 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:09.195907 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.028 seconds
[0m20:00:09.209815 [debug] [Thread-2 (]: Using postgres connection "model.final_project.manufacturers_by_country"
[0m20:00:09.211074 [debug] [Thread-2 (]: On model.final_project.manufacturers_by_country: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.manufacturers_by_country"} */
alter table "airflow"."staging"."manufacturers_by_country" rename to "manufacturers_by_country__dbt_backup"
[0m20:00:09.212838 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:00:09.217455 [debug] [Thread-2 (]: Using postgres connection "model.final_project.manufacturers_by_country"
[0m20:00:09.218527 [debug] [Thread-2 (]: On model.final_project.manufacturers_by_country: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.manufacturers_by_country"} */
alter table "airflow"."staging"."manufacturers_by_country__dbt_tmp" rename to "manufacturers_by_country"
[0m20:00:09.220304 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:00:09.223029 [debug] [Thread-2 (]: On model.final_project.manufacturers_by_country: COMMIT
[0m20:00:09.224017 [debug] [Thread-2 (]: Using postgres connection "model.final_project.manufacturers_by_country"
[0m20:00:09.224871 [debug] [Thread-2 (]: On model.final_project.manufacturers_by_country: COMMIT
[0m20:00:09.228048 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m20:00:09.232235 [debug] [Thread-2 (]: Applying DROP to: "airflow"."staging"."manufacturers_by_country__dbt_backup"
[0m20:00:09.237425 [debug] [Thread-2 (]: Using postgres connection "model.final_project.manufacturers_by_country"
[0m20:00:09.238512 [debug] [Thread-2 (]: On model.final_project.manufacturers_by_country: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.manufacturers_by_country"} */
drop table if exists "airflow"."staging"."manufacturers_by_country__dbt_backup" cascade
[0m20:00:09.243567 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m20:00:09.246074 [debug] [Thread-2 (]: On model.final_project.manufacturers_by_country: Close
[0m20:00:09.247626 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67abf515-dfd2-48f3-a824-79ebccb30c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756c495f1a60>]}
[0m20:00:09.251521 [info ] [Thread-2 (]: 3 of 3 OK created sql table model staging.manufacturers_by_country ............. [[32mSELECT 11[0m in 0.15s]
[0m20:00:09.253661 [debug] [Thread-2 (]: Finished running node model.final_project.manufacturers_by_country
[0m20:00:09.257173 [debug] [MainThread]: On master: COMMIT
[0m20:00:09.258438 [debug] [MainThread]: Using postgres connection "master"
[0m20:00:09.259560 [debug] [MainThread]: On master: COMMIT
[0m20:00:09.260637 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:00:09.274419 [debug] [MainThread]: SQL status: COMMIT in 0.014 seconds
[0m20:00:09.276008 [debug] [MainThread]: On master: Close
[0m20:00:09.277644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:00:09.278835 [debug] [MainThread]: Connection 'model.final_project.stg_manufacturers' was properly closed.
[0m20:00:09.280097 [debug] [MainThread]: Connection 'model.final_project.manufacturers_by_country' was properly closed.
[0m20:00:09.281360 [info ] [MainThread]: 
[0m20:00:09.283111 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m20:00:09.285629 [debug] [MainThread]: Command end result
[0m20:00:09.341704 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:00:09.354783 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:00:09.371168 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m20:00:09.372387 [info ] [MainThread]: 
[0m20:00:09.373900 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:00:09.375291 [info ] [MainThread]: 
[0m20:00:09.377048 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m20:00:09.379498 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5534105, "process_in_blocks": "0", "process_kernel_time": 0.837694, "process_mem_max_rss": "129140", "process_out_blocks": "0", "process_user_time": 5.222562}
[0m20:00:09.380983 [debug] [MainThread]: Command `dbt run` succeeded at 20:00:09.380741 after 2.56 seconds
[0m20:00:09.382185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756c4e21e2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756c4cc9a6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756c4c1fdfa0>]}
[0m20:00:09.383601 [debug] [MainThread]: Flushing usage events
[0m20:00:10.127722 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:00:22.399238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739a07470830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739a073d7b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739a07282b70>]}


============================== 20:00:22.416742 | 13547fe6-1e80-4e5a-b701-537ff4ffa8b4 ==============================
[0m20:00:22.416742 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:00:22.418372 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'debug': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'invocation_command': 'dbt test', 'log_path': '/opt/airflow/dbt/logs', 'introspect': 'True', 'empty': 'None', 'printer_width': '80', 'static_parser': 'True', 'log_format': 'default', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'profiles_dir': '/opt/airflow/dbt', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'fail_fast': 'False'}
[0m20:00:22.701231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13547fe6-1e80-4e5a-b701-537ff4ffa8b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739a06ce84a0>]}
[0m20:00:22.807589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13547fe6-1e80-4e5a-b701-537ff4ffa8b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739a06a075f0>]}
[0m20:00:22.809553 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:00:22.980855 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:00:23.304928 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:00:23.306005 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m20:00:23.306972 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:00:23.372021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13547fe6-1e80-4e5a-b701-537ff4ffa8b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739a05d13cb0>]}
[0m20:00:23.512570 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:00:23.525190 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:00:23.597591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13547fe6-1e80-4e5a-b701-537ff4ffa8b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739a04d3bd70>]}
[0m20:00:23.599333 [info ] [MainThread]: Found 3 models, 4 data tests, 2 sources, 463 macros
[0m20:00:23.600919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13547fe6-1e80-4e5a-b701-537ff4ffa8b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739a05123b60>]}
[0m20:00:23.604999 [info ] [MainThread]: 
[0m20:00:23.606513 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:00:23.608035 [info ] [MainThread]: 
[0m20:00:23.610212 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:00:23.618619 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_staging'
[0m20:00:23.697440 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging"
[0m20:00:23.698877 [debug] [ThreadPool]: On list_airflow_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "connection_name": "list_airflow_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m20:00:23.700304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:23.725312 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.025 seconds
[0m20:00:23.729974 [debug] [ThreadPool]: On list_airflow_staging: ROLLBACK
[0m20:00:23.732872 [debug] [ThreadPool]: On list_airflow_staging: Close
[0m20:00:23.746037 [debug] [MainThread]: Using postgres connection "master"
[0m20:00:23.747709 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:00:23.754511 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:00:23.790508 [debug] [MainThread]: SQL status: SELECT 2 in 0.036 seconds
[0m20:00:23.794953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13547fe6-1e80-4e5a-b701-537ff4ffa8b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739a06c012e0>]}
[0m20:00:23.797174 [debug] [MainThread]: On master: ROLLBACK
[0m20:00:23.799769 [debug] [MainThread]: On master: COMMIT
[0m20:00:23.801416 [debug] [MainThread]: Using postgres connection "master"
[0m20:00:23.804063 [debug] [MainThread]: On master: COMMIT
[0m20:00:23.806456 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:00:23.807696 [debug] [MainThread]: On master: Close
[0m20:00:23.817884 [debug] [Thread-1 (]: Began running node test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978
[0m20:00:23.818958 [debug] [Thread-2 (]: Began running node test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3
[0m20:00:23.819920 [info ] [Thread-1 (]: 1 of 4 START test not_null_stg_manufacturers_mfr_id ............................ [RUN]
[0m20:00:23.821420 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_vehicle_types_mfr_id ............................ [RUN]
[0m20:00:23.823026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging, now test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978)
[0m20:00:23.824591 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3'
[0m20:00:23.825698 [debug] [Thread-1 (]: Began compiling node test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978
[0m20:00:23.826848 [debug] [Thread-2 (]: Began compiling node test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3
[0m20:00:23.887307 [debug] [Thread-2 (]: Writing injected SQL for node "test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3"
[0m20:00:23.882823 [debug] [Thread-1 (]: Writing injected SQL for node "test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978"
[0m20:00:23.904453 [debug] [Thread-1 (]: Began executing node test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978
[0m20:00:23.934650 [debug] [Thread-2 (]: Began executing node test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3
[0m20:00:23.950222 [debug] [Thread-2 (]: Writing runtime sql for node "test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3"
[0m20:00:23.946454 [debug] [Thread-1 (]: Writing runtime sql for node "test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978"
[0m20:00:23.968393 [debug] [Thread-1 (]: Using postgres connection "test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978"
[0m20:00:23.970771 [debug] [Thread-1 (]: On test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select mfr_id
from "airflow"."staging"."stg_manufacturers"
where mfr_id is null



  
  
      
    ) dbt_internal_test
[0m20:00:23.972676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:23.975246 [debug] [Thread-2 (]: Using postgres connection "test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3"
[0m20:00:23.977585 [debug] [Thread-2 (]: On test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select mfr_id
from "airflow"."staging"."stg_vehicle_types"
where mfr_id is null



  
  
      
    ) dbt_internal_test
[0m20:00:23.979785 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:00:23.992274 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.020 seconds
[0m20:00:23.999671 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.020 seconds
[0m20:00:24.002989 [debug] [Thread-1 (]: On test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978: ROLLBACK
[0m20:00:24.006098 [debug] [Thread-2 (]: On test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3: ROLLBACK
[0m20:00:24.008276 [debug] [Thread-1 (]: On test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978: Close
[0m20:00:24.009795 [debug] [Thread-2 (]: On test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3: Close
[0m20:00:24.012232 [info ] [Thread-1 (]: 1 of 4 PASS not_null_stg_manufacturers_mfr_id .................................. [[32mPASS[0m in 0.19s]
[0m20:00:24.017184 [debug] [Thread-1 (]: Finished running node test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978
[0m20:00:24.014908 [info ] [Thread-2 (]: 2 of 4 PASS not_null_stg_vehicle_types_mfr_id .................................. [[32mPASS[0m in 0.19s]
[0m20:00:24.021509 [debug] [Thread-1 (]: Began running node test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7
[0m20:00:24.023403 [debug] [Thread-2 (]: Finished running node test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3
[0m20:00:24.024779 [info ] [Thread-1 (]: 3 of 4 START test relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_  [RUN]
[0m20:00:24.026264 [debug] [Thread-2 (]: Began running node test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa
[0m20:00:24.028067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978, now test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7)
[0m20:00:24.029798 [info ] [Thread-2 (]: 4 of 4 START test unique_stg_manufacturers_mfr_id .............................. [RUN]
[0m20:00:24.031278 [debug] [Thread-1 (]: Began compiling node test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7
[0m20:00:24.032640 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3, now test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa)
[0m20:00:24.045214 [debug] [Thread-2 (]: Began compiling node test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa
[0m20:00:24.048521 [debug] [Thread-1 (]: Writing injected SQL for node "test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7"
[0m20:00:24.059521 [debug] [Thread-2 (]: Writing injected SQL for node "test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa"
[0m20:00:24.075049 [debug] [Thread-2 (]: Began executing node test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa
[0m20:00:24.082231 [debug] [Thread-2 (]: Writing runtime sql for node "test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa"
[0m20:00:24.083050 [debug] [Thread-1 (]: Began executing node test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7
[0m20:00:24.088091 [debug] [Thread-1 (]: Writing runtime sql for node "test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7"
[0m20:00:24.096737 [debug] [Thread-2 (]: Using postgres connection "test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa"
[0m20:00:24.098588 [debug] [Thread-2 (]: On test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    mfr_id as unique_field,
    count(*) as n_records

from "airflow"."staging"."stg_manufacturers"
where mfr_id is not null
group by mfr_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:00:24.100061 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:24.102784 [debug] [Thread-1 (]: Using postgres connection "test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7"
[0m20:00:24.104201 [debug] [Thread-1 (]: On test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select mfr_id as from_field
    from "airflow"."staging"."stg_vehicle_types"
    where mfr_id is not null
),

parent as (
    select mfr_id as to_field
    from "airflow"."staging"."stg_manufacturers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:00:24.105514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:24.114977 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.015 seconds
[0m20:00:24.119334 [debug] [Thread-2 (]: On test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa: ROLLBACK
[0m20:00:24.120972 [debug] [Thread-2 (]: On test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa: Close
[0m20:00:24.121764 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.016 seconds
[0m20:00:24.125764 [debug] [Thread-1 (]: On test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7: ROLLBACK
[0m20:00:24.123207 [info ] [Thread-2 (]: 4 of 4 PASS unique_stg_manufacturers_mfr_id .................................... [[32mPASS[0m in 0.09s]
[0m20:00:24.127691 [debug] [Thread-1 (]: On test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7: Close
[0m20:00:24.129588 [debug] [Thread-2 (]: Finished running node test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa
[0m20:00:24.131605 [info ] [Thread-1 (]: 3 of 4 PASS relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_  [[32mPASS[0m in 0.10s]
[0m20:00:24.135801 [debug] [Thread-1 (]: Finished running node test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7
[0m20:00:24.139527 [debug] [MainThread]: On master: COMMIT
[0m20:00:24.140649 [debug] [MainThread]: Using postgres connection "master"
[0m20:00:24.142010 [debug] [MainThread]: On master: COMMIT
[0m20:00:24.143194 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:00:24.158735 [debug] [MainThread]: SQL status: COMMIT in 0.015 seconds
[0m20:00:24.160016 [debug] [MainThread]: On master: Close
[0m20:00:24.161811 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:00:24.163885 [debug] [MainThread]: Connection 'test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7' was properly closed.
[0m20:00:24.165081 [debug] [MainThread]: Connection 'test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa' was properly closed.
[0m20:00:24.166620 [info ] [MainThread]: 
[0m20:00:24.168048 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m20:00:24.171100 [debug] [MainThread]: Command end result
[0m20:00:24.239867 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:00:24.254435 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:00:24.273688 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m20:00:24.275280 [info ] [MainThread]: 
[0m20:00:24.276989 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:00:24.279026 [info ] [MainThread]: 
[0m20:00:24.280561 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m20:00:24.283810 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.0046039, "process_in_blocks": "0", "process_kernel_time": 0.860708, "process_mem_max_rss": "129072", "process_out_blocks": "0", "process_user_time": 4.114508}
[0m20:00:24.285538 [debug] [MainThread]: Command `dbt test` succeeded at 20:00:24.285223 after 2.01 seconds
[0m20:00:24.287059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739a06d566f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739a03d61760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739a094591f0>]}
[0m20:00:24.288340 [debug] [MainThread]: Flushing usage events
[0m20:00:25.294743 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:00:39.521310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7499e4f23980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7499e4015c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7499e4527aa0>]}


============================== 20:00:39.536285 | 4a5c248d-34ee-4dc7-8e10-311d9cfd94e8 ==============================
[0m20:00:39.536285 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:00:39.538275 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'printer_width': '80', 'log_cache_events': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt test', 'indirect_selection': 'eager', 'empty': 'None', 'quiet': 'False', 'static_parser': 'True', 'log_path': '/opt/airflow/dbt/logs', 'no_print': 'None', 'warn_error': 'None', 'use_experimental_parser': 'False', 'introspect': 'True', 'version_check': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'write_json': 'True', 'profiles_dir': '/opt/airflow/dbt'}
[0m20:00:39.857953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a5c248d-34ee-4dc7-8e10-311d9cfd94e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7499e3b890a0>]}
[0m20:00:40.038375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a5c248d-34ee-4dc7-8e10-311d9cfd94e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7499e5b6f4a0>]}
[0m20:00:40.040710 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:00:40.269511 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:00:40.676063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:00:40.678515 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m20:00:40.680912 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:00:40.760613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a5c248d-34ee-4dc7-8e10-311d9cfd94e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7499e33d0e30>]}
[0m20:00:40.909118 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:00:40.923928 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:00:40.990778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a5c248d-34ee-4dc7-8e10-311d9cfd94e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7499e1f27bc0>]}
[0m20:00:40.992559 [info ] [MainThread]: Found 3 models, 4 data tests, 2 sources, 463 macros
[0m20:00:40.994497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a5c248d-34ee-4dc7-8e10-311d9cfd94e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7499e2356c90>]}
[0m20:00:40.999170 [info ] [MainThread]: 
[0m20:00:41.000605 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:00:41.001814 [info ] [MainThread]: 
[0m20:00:41.003442 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:00:41.010883 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_staging'
[0m20:00:41.081302 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging"
[0m20:00:41.082609 [debug] [ThreadPool]: On list_airflow_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "connection_name": "list_airflow_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m20:00:41.083648 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:41.102217 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.018 seconds
[0m20:00:41.105031 [debug] [ThreadPool]: On list_airflow_staging: ROLLBACK
[0m20:00:41.106496 [debug] [ThreadPool]: On list_airflow_staging: Close
[0m20:00:41.117422 [debug] [MainThread]: Using postgres connection "master"
[0m20:00:41.119138 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:00:41.121014 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:00:41.137272 [debug] [MainThread]: SQL status: SELECT 2 in 0.016 seconds
[0m20:00:41.140420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a5c248d-34ee-4dc7-8e10-311d9cfd94e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7499e3adeba0>]}
[0m20:00:41.141719 [debug] [MainThread]: On master: ROLLBACK
[0m20:00:41.143101 [debug] [MainThread]: On master: COMMIT
[0m20:00:41.144298 [debug] [MainThread]: Using postgres connection "master"
[0m20:00:41.145578 [debug] [MainThread]: On master: COMMIT
[0m20:00:41.146976 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:00:41.148122 [debug] [MainThread]: On master: Close
[0m20:00:41.156016 [debug] [Thread-1 (]: Began running node test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978
[0m20:00:41.156753 [debug] [Thread-2 (]: Began running node test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3
[0m20:00:41.157470 [info ] [Thread-1 (]: 1 of 4 START test not_null_stg_manufacturers_mfr_id ............................ [RUN]
[0m20:00:41.158992 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_vehicle_types_mfr_id ............................ [RUN]
[0m20:00:41.160627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging, now test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978)
[0m20:00:41.162121 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3'
[0m20:00:41.163350 [debug] [Thread-1 (]: Began compiling node test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978
[0m20:00:41.164450 [debug] [Thread-2 (]: Began compiling node test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3
[0m20:00:41.212002 [debug] [Thread-2 (]: Writing injected SQL for node "test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3"
[0m20:00:41.216072 [debug] [Thread-1 (]: Writing injected SQL for node "test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978"
[0m20:00:41.230428 [debug] [Thread-1 (]: Began executing node test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978
[0m20:00:41.238179 [debug] [Thread-2 (]: Began executing node test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3
[0m20:00:41.296558 [debug] [Thread-1 (]: Writing runtime sql for node "test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978"
[0m20:00:41.297831 [debug] [Thread-2 (]: Writing runtime sql for node "test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3"
[0m20:00:41.313204 [debug] [Thread-2 (]: Using postgres connection "test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3"
[0m20:00:41.315026 [debug] [Thread-2 (]: On test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select mfr_id
from "airflow"."staging"."stg_vehicle_types"
where mfr_id is null



  
  
      
    ) dbt_internal_test
[0m20:00:41.316856 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:00:41.317703 [debug] [Thread-1 (]: Using postgres connection "test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978"
[0m20:00:41.319541 [debug] [Thread-1 (]: On test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select mfr_id
from "airflow"."staging"."stg_manufacturers"
where mfr_id is null



  
  
      
    ) dbt_internal_test
[0m20:00:41.321629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:41.331747 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.015 seconds
[0m20:00:41.339096 [debug] [Thread-2 (]: On test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3: ROLLBACK
[0m20:00:41.341068 [debug] [Thread-2 (]: On test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3: Close
[0m20:00:41.343061 [info ] [Thread-2 (]: 2 of 4 PASS not_null_stg_vehicle_types_mfr_id .................................. [[32mPASS[0m in 0.18s]
[0m20:00:41.344469 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.023 seconds
[0m20:00:41.348769 [debug] [Thread-2 (]: Finished running node test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3
[0m20:00:41.352396 [debug] [Thread-1 (]: On test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978: ROLLBACK
[0m20:00:41.354166 [debug] [Thread-2 (]: Began running node test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7
[0m20:00:41.356170 [debug] [Thread-1 (]: On test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978: Close
[0m20:00:41.357155 [info ] [Thread-2 (]: 3 of 4 START test relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_  [RUN]
[0m20:00:41.360051 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3, now test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7)
[0m20:00:41.359080 [info ] [Thread-1 (]: 1 of 4 PASS not_null_stg_manufacturers_mfr_id .................................. [[32mPASS[0m in 0.20s]
[0m20:00:41.361628 [debug] [Thread-2 (]: Began compiling node test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7
[0m20:00:41.363508 [debug] [Thread-1 (]: Finished running node test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978
[0m20:00:41.378759 [debug] [Thread-2 (]: Writing injected SQL for node "test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7"
[0m20:00:41.379726 [debug] [Thread-1 (]: Began running node test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa
[0m20:00:41.381939 [info ] [Thread-1 (]: 4 of 4 START test unique_stg_manufacturers_mfr_id .............................. [RUN]
[0m20:00:41.383980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978, now test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa)
[0m20:00:41.385337 [debug] [Thread-1 (]: Began compiling node test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa
[0m20:00:41.397626 [debug] [Thread-1 (]: Writing injected SQL for node "test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa"
[0m20:00:41.406024 [debug] [Thread-2 (]: Began executing node test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7
[0m20:00:41.412428 [debug] [Thread-2 (]: Writing runtime sql for node "test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7"
[0m20:00:41.413370 [debug] [Thread-1 (]: Began executing node test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa
[0m20:00:41.419607 [debug] [Thread-1 (]: Writing runtime sql for node "test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa"
[0m20:00:41.428609 [debug] [Thread-2 (]: Using postgres connection "test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7"
[0m20:00:41.430703 [debug] [Thread-2 (]: On test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select mfr_id as from_field
    from "airflow"."staging"."stg_vehicle_types"
    where mfr_id is not null
),

parent as (
    select mfr_id as to_field
    from "airflow"."staging"."stg_manufacturers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:00:41.432387 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:41.433279 [debug] [Thread-1 (]: Using postgres connection "test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa"
[0m20:00:41.435186 [debug] [Thread-1 (]: On test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    mfr_id as unique_field,
    count(*) as n_records

from "airflow"."staging"."stg_manufacturers"
where mfr_id is not null
group by mfr_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:00:41.436872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:41.448012 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.016 seconds
[0m20:00:41.451923 [debug] [Thread-2 (]: On test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7: ROLLBACK
[0m20:00:41.452740 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.016 seconds
[0m20:00:41.453974 [debug] [Thread-2 (]: On test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7: Close
[0m20:00:41.456623 [debug] [Thread-1 (]: On test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa: ROLLBACK
[0m20:00:41.458856 [info ] [Thread-2 (]: 3 of 4 PASS relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_  [[32mPASS[0m in 0.10s]
[0m20:00:41.460989 [debug] [Thread-1 (]: On test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa: Close
[0m20:00:41.462305 [debug] [Thread-2 (]: Finished running node test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7
[0m20:00:41.464429 [info ] [Thread-1 (]: 4 of 4 PASS unique_stg_manufacturers_mfr_id .................................... [[32mPASS[0m in 0.08s]
[0m20:00:41.469694 [debug] [Thread-1 (]: Finished running node test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa
[0m20:00:41.474222 [debug] [MainThread]: On master: COMMIT
[0m20:00:41.475504 [debug] [MainThread]: Using postgres connection "master"
[0m20:00:41.477063 [debug] [MainThread]: On master: COMMIT
[0m20:00:41.478712 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:00:41.491178 [debug] [MainThread]: SQL status: COMMIT in 0.012 seconds
[0m20:00:41.492538 [debug] [MainThread]: On master: Close
[0m20:00:41.494471 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:00:41.495834 [debug] [MainThread]: Connection 'test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa' was properly closed.
[0m20:00:41.497238 [debug] [MainThread]: Connection 'test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7' was properly closed.
[0m20:00:41.498676 [info ] [MainThread]: 
[0m20:00:41.499995 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m20:00:41.502708 [debug] [MainThread]: Command end result
[0m20:00:41.569242 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:00:41.581945 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:00:41.601361 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m20:00:41.602690 [info ] [MainThread]: 
[0m20:00:41.604131 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:00:41.605373 [info ] [MainThread]: 
[0m20:00:41.606769 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m20:00:41.609145 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.2279208, "process_in_blocks": "0", "process_kernel_time": 0.949789, "process_mem_max_rss": "129972", "process_out_blocks": "0", "process_user_time": 5.674894}
[0m20:00:41.610754 [debug] [MainThread]: Command `dbt test` succeeded at 20:00:41.610506 after 2.23 seconds
[0m20:00:41.612087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7499e3e49fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7499e5b283e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7499e33d1ca0>]}
[0m20:00:41.613338 [debug] [MainThread]: Flushing usage events
[0m20:00:42.397720 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:01:02.676820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708ba50f0f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708ba77a8530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708ba50f0a10>]}


============================== 20:01:02.693772 | 9c381814-8d6e-4afb-86ff-9329a69f4815 ==============================
[0m20:01:02.693772 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:01:02.695321 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'version_check': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'use_colors': 'True', 'static_parser': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'quiet': 'False', 'log_path': '/opt/airflow/dbt/logs', 'introspect': 'True', 'no_print': 'None', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'use_experimental_parser': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True'}
[0m20:01:03.022169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c381814-8d6e-4afb-86ff-9329a69f4815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708ba55d9190>]}
[0m20:01:03.126496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c381814-8d6e-4afb-86ff-9329a69f4815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708ba50f04a0>]}
[0m20:01:03.128734 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:01:03.298091 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:01:03.723143 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:01:03.724647 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m20:01:03.726723 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:01:03.828020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c381814-8d6e-4afb-86ff-9329a69f4815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708ba3902990>]}
[0m20:01:04.035634 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:01:04.051272 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:01:04.132629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c381814-8d6e-4afb-86ff-9329a69f4815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708ba2927d10>]}
[0m20:01:04.134282 [info ] [MainThread]: Found 3 models, 4 data tests, 2 sources, 463 macros
[0m20:01:04.135936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c381814-8d6e-4afb-86ff-9329a69f4815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708ba2d54230>]}
[0m20:01:04.140670 [info ] [MainThread]: 
[0m20:01:04.142648 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:01:04.145120 [info ] [MainThread]: 
[0m20:01:04.147666 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:01:04.155592 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_staging'
[0m20:01:04.234535 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging"
[0m20:01:04.236130 [debug] [ThreadPool]: On list_airflow_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "connection_name": "list_airflow_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m20:01:04.237582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:01:04.260917 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.023 seconds
[0m20:01:04.264724 [debug] [ThreadPool]: On list_airflow_staging: ROLLBACK
[0m20:01:04.266640 [debug] [ThreadPool]: On list_airflow_staging: Close
[0m20:01:04.278755 [debug] [MainThread]: Using postgres connection "master"
[0m20:01:04.280148 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:01:04.281795 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:01:04.304339 [debug] [MainThread]: SQL status: SELECT 2 in 0.022 seconds
[0m20:01:04.307037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c381814-8d6e-4afb-86ff-9329a69f4815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708ba7141160>]}
[0m20:01:04.308923 [debug] [MainThread]: On master: ROLLBACK
[0m20:01:04.310791 [debug] [MainThread]: On master: COMMIT
[0m20:01:04.312338 [debug] [MainThread]: Using postgres connection "master"
[0m20:01:04.314063 [debug] [MainThread]: On master: COMMIT
[0m20:01:04.315890 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:01:04.317072 [debug] [MainThread]: On master: Close
[0m20:01:04.326552 [debug] [Thread-1 (]: Began running node test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978
[0m20:01:04.327531 [debug] [Thread-2 (]: Began running node test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3
[0m20:01:04.328511 [info ] [Thread-1 (]: 1 of 4 START test not_null_stg_manufacturers_mfr_id ............................ [RUN]
[0m20:01:04.329850 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_vehicle_types_mfr_id ............................ [RUN]
[0m20:01:04.331247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging, now test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978)
[0m20:01:04.332865 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3'
[0m20:01:04.334221 [debug] [Thread-1 (]: Began compiling node test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978
[0m20:01:04.335333 [debug] [Thread-2 (]: Began compiling node test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3
[0m20:01:04.376691 [debug] [Thread-1 (]: Writing injected SQL for node "test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978"
[0m20:01:04.380454 [debug] [Thread-2 (]: Writing injected SQL for node "test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3"
[0m20:01:04.396706 [debug] [Thread-2 (]: Began executing node test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3
[0m20:01:04.404855 [debug] [Thread-1 (]: Began executing node test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978
[0m20:01:04.465092 [debug] [Thread-2 (]: Writing runtime sql for node "test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3"
[0m20:01:04.468679 [debug] [Thread-1 (]: Writing runtime sql for node "test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978"
[0m20:01:04.494349 [debug] [Thread-2 (]: Using postgres connection "test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3"
[0m20:01:04.496526 [debug] [Thread-2 (]: On test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select mfr_id
from "airflow"."staging"."stg_vehicle_types"
where mfr_id is null



  
  
      
    ) dbt_internal_test
[0m20:01:04.498539 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:01:04.499966 [debug] [Thread-1 (]: Using postgres connection "test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978"
[0m20:01:04.501946 [debug] [Thread-1 (]: On test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select mfr_id
from "airflow"."staging"."stg_manufacturers"
where mfr_id is null



  
  
      
    ) dbt_internal_test
[0m20:01:04.503836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:01:04.517239 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.019 seconds
[0m20:01:04.526851 [debug] [Thread-2 (]: On test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3: ROLLBACK
[0m20:01:04.528680 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.025 seconds
[0m20:01:04.534967 [debug] [Thread-1 (]: On test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978: ROLLBACK
[0m20:01:04.536093 [debug] [Thread-2 (]: On test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3: Close
[0m20:01:04.537535 [debug] [Thread-1 (]: On test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978: Close
[0m20:01:04.539221 [info ] [Thread-2 (]: 2 of 4 PASS not_null_stg_vehicle_types_mfr_id .................................. [[32mPASS[0m in 0.21s]
[0m20:01:04.544721 [debug] [Thread-2 (]: Finished running node test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3
[0m20:01:04.542503 [info ] [Thread-1 (]: 1 of 4 PASS not_null_stg_manufacturers_mfr_id .................................. [[32mPASS[0m in 0.21s]
[0m20:01:04.550399 [debug] [Thread-2 (]: Began running node test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7
[0m20:01:04.552250 [debug] [Thread-1 (]: Finished running node test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978
[0m20:01:04.553643 [info ] [Thread-2 (]: 3 of 4 START test relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_  [RUN]
[0m20:01:04.555642 [debug] [Thread-1 (]: Began running node test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa
[0m20:01:04.557118 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3, now test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7)
[0m20:01:04.558518 [info ] [Thread-1 (]: 4 of 4 START test unique_stg_manufacturers_mfr_id .............................. [RUN]
[0m20:01:04.560886 [debug] [Thread-2 (]: Began compiling node test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7
[0m20:01:04.563210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978, now test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa)
[0m20:01:04.578911 [debug] [Thread-2 (]: Writing injected SQL for node "test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7"
[0m20:01:04.580274 [debug] [Thread-1 (]: Began compiling node test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa
[0m20:01:04.593526 [debug] [Thread-1 (]: Writing injected SQL for node "test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa"
[0m20:01:04.605824 [debug] [Thread-2 (]: Began executing node test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7
[0m20:01:04.613395 [debug] [Thread-2 (]: Writing runtime sql for node "test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7"
[0m20:01:04.614387 [debug] [Thread-1 (]: Began executing node test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa
[0m20:01:04.619975 [debug] [Thread-1 (]: Writing runtime sql for node "test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa"
[0m20:01:04.629430 [debug] [Thread-2 (]: Using postgres connection "test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7"
[0m20:01:04.631627 [debug] [Thread-2 (]: On test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select mfr_id as from_field
    from "airflow"."staging"."stg_vehicle_types"
    where mfr_id is not null
),

parent as (
    select mfr_id as to_field
    from "airflow"."staging"."stg_manufacturers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:01:04.633770 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:01:04.634851 [debug] [Thread-1 (]: Using postgres connection "test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa"
[0m20:01:04.636599 [debug] [Thread-1 (]: On test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    mfr_id as unique_field,
    count(*) as n_records

from "airflow"."staging"."stg_manufacturers"
where mfr_id is not null
group by mfr_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:01:04.638166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:01:04.650303 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.016 seconds
[0m20:01:04.653701 [debug] [Thread-2 (]: On test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7: ROLLBACK
[0m20:01:04.654933 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m20:01:04.656404 [debug] [Thread-2 (]: On test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7: Close
[0m20:01:04.659440 [debug] [Thread-1 (]: On test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa: ROLLBACK
[0m20:01:04.662588 [info ] [Thread-2 (]: 3 of 4 PASS relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_  [[32mPASS[0m in 0.11s]
[0m20:01:04.667621 [debug] [Thread-1 (]: On test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa: Close
[0m20:01:04.668959 [debug] [Thread-2 (]: Finished running node test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7
[0m20:01:04.671013 [info ] [Thread-1 (]: 4 of 4 PASS unique_stg_manufacturers_mfr_id .................................... [[32mPASS[0m in 0.11s]
[0m20:01:04.673119 [debug] [Thread-1 (]: Finished running node test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa
[0m20:01:04.677467 [debug] [MainThread]: On master: COMMIT
[0m20:01:04.678727 [debug] [MainThread]: Using postgres connection "master"
[0m20:01:04.680059 [debug] [MainThread]: On master: COMMIT
[0m20:01:04.681426 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:01:04.695291 [debug] [MainThread]: SQL status: COMMIT in 0.014 seconds
[0m20:01:04.696641 [debug] [MainThread]: On master: Close
[0m20:01:04.698290 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:01:04.699617 [debug] [MainThread]: Connection 'test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa' was properly closed.
[0m20:01:04.700717 [debug] [MainThread]: Connection 'test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7' was properly closed.
[0m20:01:04.701802 [info ] [MainThread]: 
[0m20:01:04.703080 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m20:01:04.705639 [debug] [MainThread]: Command end result
[0m20:01:04.765671 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:01:04.779764 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:01:04.799518 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m20:01:04.800638 [info ] [MainThread]: 
[0m20:01:04.801939 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:01:04.803285 [info ] [MainThread]: 
[0m20:01:04.804724 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m20:01:04.807370 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.2551444, "process_in_blocks": "0", "process_kernel_time": 0.997486, "process_mem_max_rss": "129852", "process_out_blocks": "0", "process_user_time": 5.421297}
[0m20:01:04.809455 [debug] [MainThread]: Command `dbt test` succeeded at 20:01:04.808991 after 2.26 seconds
[0m20:01:04.811680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708ba74fc8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708ba5737680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708ba49221e0>]}
[0m20:01:04.813311 [debug] [MainThread]: Flushing usage events
[0m20:01:05.622786 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:01:20.265629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec65365a6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec655ac8980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec656d48830>]}


============================== 20:01:20.288972 | 644468de-a053-47b5-8d07-57fc12facab0 ==============================
[0m20:01:20.288972 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:01:20.290782 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'invocation_command': 'dbt test', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'quiet': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'version_check': 'True', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'empty': 'None', 'write_json': 'True', 'use_colors': 'True', 'log_cache_events': 'False'}
[0m20:01:20.622539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '644468de-a053-47b5-8d07-57fc12facab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec655679ca0>]}
[0m20:01:20.737865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '644468de-a053-47b5-8d07-57fc12facab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec652318a40>]}
[0m20:01:20.740447 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:01:20.919061 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:01:21.313285 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:01:21.314900 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m20:01:21.316382 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:01:21.390954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '644468de-a053-47b5-8d07-57fc12facab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec6523d66f0>]}
[0m20:01:21.562591 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:01:21.576534 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:01:21.648484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '644468de-a053-47b5-8d07-57fc12facab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec650f3c110>]}
[0m20:01:21.650137 [info ] [MainThread]: Found 3 models, 4 data tests, 2 sources, 463 macros
[0m20:01:21.651720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '644468de-a053-47b5-8d07-57fc12facab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec6523d4b60>]}
[0m20:01:21.656189 [info ] [MainThread]: 
[0m20:01:21.657565 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:01:21.658915 [info ] [MainThread]: 
[0m20:01:21.661299 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:01:21.670076 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_staging'
[0m20:01:21.747554 [debug] [ThreadPool]: Using postgres connection "list_airflow_staging"
[0m20:01:21.748611 [debug] [ThreadPool]: On list_airflow_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "connection_name": "list_airflow_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m20:01:21.749603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:01:21.774902 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.025 seconds
[0m20:01:21.777717 [debug] [ThreadPool]: On list_airflow_staging: ROLLBACK
[0m20:01:21.779286 [debug] [ThreadPool]: On list_airflow_staging: Close
[0m20:01:21.791099 [debug] [MainThread]: Using postgres connection "master"
[0m20:01:21.792669 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:01:21.794276 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:01:21.822454 [debug] [MainThread]: SQL status: SELECT 2 in 0.028 seconds
[0m20:01:21.826375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '644468de-a053-47b5-8d07-57fc12facab0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec655715040>]}
[0m20:01:21.828341 [debug] [MainThread]: On master: ROLLBACK
[0m20:01:21.830303 [debug] [MainThread]: On master: COMMIT
[0m20:01:21.831812 [debug] [MainThread]: Using postgres connection "master"
[0m20:01:21.833205 [debug] [MainThread]: On master: COMMIT
[0m20:01:21.836215 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:01:21.838279 [debug] [MainThread]: On master: Close
[0m20:01:21.852739 [debug] [Thread-1 (]: Began running node test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978
[0m20:01:21.854470 [debug] [Thread-2 (]: Began running node test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3
[0m20:01:21.856058 [info ] [Thread-1 (]: 1 of 4 START test not_null_stg_manufacturers_mfr_id ............................ [RUN]
[0m20:01:21.858476 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_vehicle_types_mfr_id ............................ [RUN]
[0m20:01:21.860534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_staging, now test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978)
[0m20:01:21.863296 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3'
[0m20:01:21.865623 [debug] [Thread-1 (]: Began compiling node test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978
[0m20:01:21.867214 [debug] [Thread-2 (]: Began compiling node test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3
[0m20:01:21.943418 [debug] [Thread-1 (]: Writing injected SQL for node "test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978"
[0m20:01:21.951221 [debug] [Thread-2 (]: Writing injected SQL for node "test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3"
[0m20:01:21.967199 [debug] [Thread-1 (]: Began executing node test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978
[0m20:01:22.001210 [debug] [Thread-2 (]: Began executing node test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3
[0m20:01:22.025685 [debug] [Thread-1 (]: Writing runtime sql for node "test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978"
[0m20:01:22.026986 [debug] [Thread-2 (]: Writing runtime sql for node "test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3"
[0m20:01:22.044060 [debug] [Thread-1 (]: Using postgres connection "test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978"
[0m20:01:22.046297 [debug] [Thread-1 (]: On test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select mfr_id
from "airflow"."staging"."stg_manufacturers"
where mfr_id is null



  
  
      
    ) dbt_internal_test
[0m20:01:22.047754 [debug] [Thread-2 (]: Using postgres connection "test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3"
[0m20:01:22.048748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:01:22.050316 [debug] [Thread-2 (]: On test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select mfr_id
from "airflow"."staging"."stg_vehicle_types"
where mfr_id is null



  
  
      
    ) dbt_internal_test
[0m20:01:22.054445 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:01:22.067354 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.013 seconds
[0m20:01:22.068355 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.020 seconds
[0m20:01:22.075468 [debug] [Thread-2 (]: On test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3: ROLLBACK
[0m20:01:22.079941 [debug] [Thread-1 (]: On test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978: ROLLBACK
[0m20:01:22.082237 [debug] [Thread-2 (]: On test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3: Close
[0m20:01:22.083850 [debug] [Thread-1 (]: On test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978: Close
[0m20:01:22.085454 [info ] [Thread-2 (]: 2 of 4 PASS not_null_stg_vehicle_types_mfr_id .................................. [[32mPASS[0m in 0.22s]
[0m20:01:22.088650 [info ] [Thread-1 (]: 1 of 4 PASS not_null_stg_manufacturers_mfr_id .................................. [[32mPASS[0m in 0.23s]
[0m20:01:22.092500 [debug] [Thread-2 (]: Finished running node test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3
[0m20:01:22.094834 [debug] [Thread-1 (]: Finished running node test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978
[0m20:01:22.096605 [debug] [Thread-2 (]: Began running node test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7
[0m20:01:22.098407 [debug] [Thread-1 (]: Began running node test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa
[0m20:01:22.100390 [info ] [Thread-2 (]: 3 of 4 START test relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_  [RUN]
[0m20:01:22.101753 [info ] [Thread-1 (]: 4 of 4 START test unique_stg_manufacturers_mfr_id .............................. [RUN]
[0m20:01:22.103116 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.final_project.not_null_stg_vehicle_types_mfr_id.12347451a3, now test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7)
[0m20:01:22.104549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.final_project.not_null_stg_manufacturers_mfr_id.4b966ab978, now test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa)
[0m20:01:22.105829 [debug] [Thread-2 (]: Began compiling node test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7
[0m20:01:22.106958 [debug] [Thread-1 (]: Began compiling node test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa
[0m20:01:22.128949 [debug] [Thread-2 (]: Writing injected SQL for node "test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7"
[0m20:01:22.134069 [debug] [Thread-1 (]: Writing injected SQL for node "test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa"
[0m20:01:22.151267 [debug] [Thread-1 (]: Began executing node test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa
[0m20:01:22.158224 [debug] [Thread-1 (]: Writing runtime sql for node "test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa"
[0m20:01:22.159219 [debug] [Thread-2 (]: Began executing node test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7
[0m20:01:22.164959 [debug] [Thread-2 (]: Writing runtime sql for node "test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7"
[0m20:01:22.173850 [debug] [Thread-1 (]: Using postgres connection "test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa"
[0m20:01:22.175551 [debug] [Thread-1 (]: On test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    mfr_id as unique_field,
    count(*) as n_records

from "airflow"."staging"."stg_manufacturers"
where mfr_id is not null
group by mfr_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:01:22.177476 [debug] [Thread-2 (]: Using postgres connection "test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7"
[0m20:01:22.178312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:01:22.179626 [debug] [Thread-2 (]: On test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "final_project", "target_name": "dev", "node_id": "test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select mfr_id as from_field
    from "airflow"."staging"."stg_vehicle_types"
    where mfr_id is not null
),

parent as (
    select mfr_id as to_field
    from "airflow"."staging"."stg_manufacturers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m20:01:22.181444 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:01:22.194220 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.016 seconds
[0m20:01:22.197929 [debug] [Thread-1 (]: On test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa: ROLLBACK
[0m20:01:22.198811 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.017 seconds
[0m20:01:22.200248 [debug] [Thread-1 (]: On test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa: Close
[0m20:01:22.202945 [debug] [Thread-2 (]: On test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7: ROLLBACK
[0m20:01:22.205721 [info ] [Thread-1 (]: 4 of 4 PASS unique_stg_manufacturers_mfr_id .................................... [[32mPASS[0m in 0.10s]
[0m20:01:22.208500 [debug] [Thread-2 (]: On test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7: Close
[0m20:01:22.209840 [debug] [Thread-1 (]: Finished running node test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa
[0m20:01:22.212048 [info ] [Thread-2 (]: 3 of 4 PASS relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_  [[32mPASS[0m in 0.11s]
[0m20:01:22.214438 [debug] [Thread-2 (]: Finished running node test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7
[0m20:01:22.218216 [debug] [MainThread]: On master: COMMIT
[0m20:01:22.219432 [debug] [MainThread]: Using postgres connection "master"
[0m20:01:22.220659 [debug] [MainThread]: On master: COMMIT
[0m20:01:22.221692 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:01:22.234544 [debug] [MainThread]: SQL status: COMMIT in 0.013 seconds
[0m20:01:22.235913 [debug] [MainThread]: On master: Close
[0m20:01:22.237155 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:01:22.238183 [debug] [MainThread]: Connection 'test.final_project.unique_stg_manufacturers_mfr_id.25d8f8a0aa' was properly closed.
[0m20:01:22.239119 [debug] [MainThread]: Connection 'test.final_project.relationships_stg_vehicle_types_mfr_id__mfr_id__ref_stg_manufacturers_.296ffc0eb7' was properly closed.
[0m20:01:22.240157 [info ] [MainThread]: 
[0m20:01:22.241332 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m20:01:22.243916 [debug] [MainThread]: Command end result
[0m20:01:22.304113 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:01:22.319059 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:01:22.345807 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m20:01:22.347793 [info ] [MainThread]: 
[0m20:01:22.349843 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:01:22.351893 [info ] [MainThread]: 
[0m20:01:22.354265 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m20:01:22.362440 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.2509887, "process_in_blocks": "0", "process_kernel_time": 0.809607, "process_mem_max_rss": "129420", "process_out_blocks": "0", "process_user_time": 4.684445}
[0m20:01:22.365788 [debug] [MainThread]: Command `dbt test` succeeded at 20:01:22.365348 after 2.25 seconds
[0m20:01:22.368296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec652cec7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec651b38ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec653b42f90>]}
[0m20:01:22.370267 [debug] [MainThread]: Flushing usage events
[0m20:01:23.114114 [debug] [MainThread]: An error was encountered while trying to flush usage events
